import{d as Q,r as i,o as Y,P as h,c as p,e as V,k as G,D as t,w as n,ac as w,g as l,l as E,m as x,Y as H,ae as J,ai as K,bL as W,bM as C,bN as X,bO as Z,bP as ee,al as b,E as te,bQ as oe,bR as le}from"./index-CvzrRroh.js";/* empty css                   *//* empty css                     *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  *//* empty css                       *//* empty css                    */import{E as ae}from"./el-popover-r7HNwi93.js";/* empty css                  *//* empty css                  */import{u as ne}from"./menus-CtHO1wFe.js";import{S as se}from"./SytTable-DOssZ1nG.js";import{E as re}from"./index-qChH8gpH.js";import{E as ie}from"./index-BmUq3rwC.js";import{E as me,a as pe}from"./index-DOm-affa.js";import{E as de}from"./index-4nPvsJKo.js";import{E as ue}from"./index-Db-N1C6d.js";import{a as ce}from"./index-B31ZYaE2.js";import{b as fe}from"./index-CLlMxQjo.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-Dhfn7e9K.js";import"./error-Br4eXv7y.js";import"./index-A2_hR_AC.js";import"./index-BQjoHAmH.js";import"./index-BpYBCOKL.js";import"./isEqual-Bw39J2LG.js";import"./castArray-BGWFyrrn.js";import"./index-Cbqz8tSS.js";import"./_baseClone-CuXz6tC2.js";import"./dropdown-KP4DAjH2.js";import"./index-DcW111rC.js";import"./vnode-DVMq17-v.js";const ge={class:"container"},be={class:"tools"},ve={key:1,class:"icon-select-text"},Ve=Q({__name:"Menus",setup(Ee){const D=i([{title:"路由名",dataIndex:"name"},{title:"路由路径",dataIndex:"path"},{title:"组件路径",dataIndex:"component"},{title:"菜单名",dataIndex:"meta.title"},{title:"显示菜单",dataIndex:"meta.showLink"}]),I=ne();let v=i([]),M=i(!0),m=i(!1),k=i(null),u=i("");const L=i({name:[{required:!0,message:"请输入路由名",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件路径",trigger:"blur"}],"meta.title":[{required:!0,message:"请输入菜单名",trigger:"blur"}],"meta.showLink":[{required:!0,message:"显示菜单",trigger:"change"}]});let y=()=>({pid:"",path:"",name:"",component:"",meta:{icon:"",title:"",showLink:!0}}),a=i(y());const c=async()=>{await W().then(s=>{s.code===200&&(s.data.forEach(e=>{var d;e.iconComponent=C[(d=e.meta)==null?void 0:d.icon]}),v.value=X(s.data),I.SAVE_MENUS(s.data))}),M.value=!1},S=()=>{u.value="添加",m.value=!0,a.value=y()},U=s=>{u.value="编辑",m.value=!0,a.value=Z(s)},B=async()=>{let s=Object.assign({},a.value);oe(s).then(e=>{e.code==200&&(b({type:"success",message:"添加成功"}),c())})},F=async()=>{let s=Object.assign({},a.value);le(s).then(e=>{e.code==200&&(b({type:"success",message:"编辑成功"}),c())})},R=s=>{s._id?ee({_id:s._id}).then(e=>{e.code==200&&(b({type:"success",message:"删除成功"}),c())}):b({type:"error",message:"不存在的_id"})},T=s=>{s&&s.validate(e=>{e?(u.value==="添加"?B():F(),m.value=!1):console.log("验证失败!")})};return Y(()=>{c()}),(s,e)=>{const d=re,q=h("Edit"),f=te,N=h("Delete"),O=ae,_=ie,r=me,P=de,z=ue,$=ce,j=pe,A=fe;return p(),V("div",ge,[G("div",be,[t(d,{onClick:S},{default:n(()=>[w("添加菜单")]),_:1})]),t(se,{columns:D.value,data:l(v)},{operations:n(({row:o})=>[t(f,{class:"icon",color:"#0af",onClick:g=>U(o)},{default:n(()=>[t(q)]),_:2},1032,["onClick"]),t(O,{title:"确定删除?",onConfirm:g=>R(o)},{reference:n(()=>[t(f,{class:"icon",color:"#f00"},{default:n(()=>[t(N)]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["columns","data"]),t(A,{modelValue:l(m),"onUpdate:modelValue":e[7]||(e[7]=o=>K(m)?m.value=o:m=o),title:l(u),width:"350px"},{default:n(()=>[t(j,{ref_key:"ruleFormRef",ref:k,model:l(a),rules:L.value,size:"large",class:"w-full","label-width":"auto"},{default:n(()=>[t(r,{label:"路由名",prop:"name"},{default:n(()=>[t(_,{modelValue:l(a).name,"onUpdate:modelValue":e[0]||(e[0]=o=>l(a).name=o),placeholder:"路由名"},null,8,["modelValue"])]),_:1}),t(r,{label:"路由路径",prop:"path"},{default:n(()=>[t(_,{modelValue:l(a).path,"onUpdate:modelValue":e[1]||(e[1]=o=>l(a).path=o),placeholder:"需包含上级菜单的路径"},null,8,["modelValue"])]),_:1}),t(r,{label:"组件路径",prop:"component"},{default:n(()=>[t(_,{modelValue:l(a).component,"onUpdate:modelValue":e[2]||(e[2]=o=>l(a).component=o),placeholder:"/src/views/**.vue"},null,8,["modelValue"])]),_:1}),t(r,{label:"菜单名",prop:"meta.title"},{default:n(()=>[t(_,{modelValue:l(a).meta.title,"onUpdate:modelValue":e[3]||(e[3]=o=>l(a).meta.title=o),placeholder:"菜单名"},null,8,["modelValue"])]),_:1}),t(r,{label:"显示菜单",prop:"meta.showLink"},{default:n(()=>[t(P,{modelValue:l(a).meta.showLink,"onUpdate:modelValue":e[4]||(e[4]=o=>l(a).meta.showLink=o)},null,8,["modelValue"])]),_:1}),t(r,{label:"菜单图标",prop:"meta.icon"},{default:n(()=>[t(z,{title:"图标",width:350,placement:"top",trigger:"click"},{reference:n(()=>[l(a).meta.icon?(p(),E(f,{key:0,size:20,class:"icon"},{default:n(()=>[(p(),E(x(l(a).meta.icon)))]),_:1})):(p(),V("span",ve,"选择图标"))]),default:n(()=>[(p(),V(H,null,J(C,(o,g)=>t(f,{key:g,class:"icon",size:15,onClick:ke=>l(a).meta.icon=g},{default:n(()=>[(p(),E(x(o)))]),_:2},1032,["onClick"])),64))]),_:1})]),_:1}),t(r,{label:"上级菜单"},{default:n(()=>[t($,{modelValue:l(a).pid,"onUpdate:modelValue":e[5]||(e[5]=o=>l(a).pid=o),data:l(v),props:{label:o=>o.meta.title,value:"id"},"check-strictly":"","render-after-expand":!1,clearable:"",style:{width:"240px"}},null,8,["modelValue","data","props"])]),_:1}),t(r,null,{default:n(()=>[t(d,{class:"w-full",type:"primary",onClick:e[6]||(e[6]=o=>T(l(k)))},{default:n(()=>[w(" 保存 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),ot=_e(Ve,[["__scopeId","data-v-e306cf4b"]]);export{ot as default};
