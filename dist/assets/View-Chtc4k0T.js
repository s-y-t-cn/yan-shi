import{d as U,ah as z,r as c,N as J,y as L,c as i,l as b,w as o,D as s,k as d,t as k,g as n,e as D,ae as I,Y as x,ac as v,A as R,am as $,an as j}from"./index-CvzrRroh.js";import{E as A,S as P}from"./SytPreviewItem-DKMedW9x.js";/* empty css                  */import{E as W,a as Y}from"./el-timeline-item-DaWK3-QH.js";import{E as q}from"./el-card-CeNxBv2S.js";/* empty css                     */import{w as G,f as H}from"./examples-BN9ghPZ7.js";import{a as K}from"./index-DOm-affa.js";import{E as M}from"./index-qChH8gpH.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vnode-DVMq17-v.js";/* empty css                 *//* empty css                  *//* empty css               *//* empty css                    */import"./el-radio-Bnf4y1jI.js";/* empty css                  */import"./index-BmUq3rwC.js";import"./error-Br4eXv7y.js";import"./index-CRTUtFhj.js";import"./index-CR5Ieg7N.js";import"./index-Bbyyluvs.js";import"./index-Cbqz8tSS.js";import"./isEqual-Bw39J2LG.js";import"./index-BQjoHAmH.js";import"./index-Dhfn7e9K.js";import"./index-BpYBCOKL.js";import"./castArray-BGWFyrrn.js";import"./index-D3GcvVds.js";import"./_commonjsHelpers-BosuxZz1.js";import"./index-7gj8T3nu.js";import"./_baseClone-CuXz6tC2.js";import"./position-BvmUxjYd.js";const X=f=>($("data-v-ffb59fe0"),f=f(),j(),f),Z=X(()=>d("span",null,"流程",-1)),ee=U({__name:"View",props:{data:Object},emits:["examine"],setup(f,{emit:h}){const V=z(),g=f,F=h;let a=c({name:"",status:"",submitter:{},formData:[],flowData:[]}),_=c(!1);J(()=>JSON.parse(JSON.stringify(g.data)),async t=>{let e=t.formData,r=(await H({name:t.name})).data.formData;for(let m in e)N(m,r).value=e[m];a.value=t,a.value.formData=r,_.value=!1},{deep:!0,immediate:!0});const N=(t,e)=>{for(let r of e)if(r.type==="layout"){for(let m of r.cols)for(let u of m.children)if(t===u.field)return u}else if(t===r.field)return r};let p=c({flowId:"",examineId:"",status:""}),B=L(()=>{let t=a.value.flowData.map(e=>{switch(p.value.flowId=a.value._id,e.status){case"未处理":e.color="";break;case"处理中":e.color="",e.username===V.username&&(_.value=!0,p.value.examineId=e.id);break;case"通过":e.color="#00aabb";break;case"否决":e.color="#ff0000"}return e});return t.unshift({type:"发起人",label:a.value.submitter.nickname,color:"#00aabb"}),t});const E=c(),S=t=>{p.value.status=t,G(p.value).then(()=>F("examine"))};return(t,e)=>{const r=K,m=q,u=Y,C=W,y=M,T=A;return i(),b(T,{direction:"vertical",fill:"",class:"submit-container"},{default:o(()=>[s(m,null,{header:o(()=>[d("h1",null,k(n(a).name),1)]),default:o(()=>[s(r,{ref_key:"ruleFormRef",ref:E,model:n(a).formData,disabled:""},{default:o(()=>[(i(!0),D(x,null,I(n(a).formData,(l,w)=>(i(),b(P,{key:l.field,modelValue:n(a).formData[w],"onUpdate:modelValue":O=>n(a).formData[w]=O,index:w.toString(),"rule-form-ref":E.value},null,8,["modelValue","onUpdate:modelValue","index","rule-form-ref"]))),128))]),_:1},8,["model"])]),_:1}),s(m,null,{header:o(()=>[Z]),default:o(()=>[s(C,null,{default:o(()=>[(i(!0),D(x,null,I(n(B),l=>(i(),b(u,{key:l.id,color:l.color,timestamp:l.timestamp},{default:o(()=>[d("div",null,k(l.type),1),d("div",null,k(l.label),1)]),_:2},1032,["color","timestamp"]))),128))]),_:1}),n(_)?(i(),D(x,{key:0},[s(y,{size:"small",type:"warning",onClick:e[0]||(e[0]=l=>S("通过")),icon:"SuccessFilled"},{default:o(()=>[v(" 通过 ")]),_:1}),s(y,{size:"small",type:"danger",onClick:e[1]||(e[1]=l=>S("否决")),icon:"Failed"},{default:o(()=>[v(" 否决 ")]),_:1})],64)):R("",!0)]),_:1})]),_:1})}}}),Oe=Q(ee,[["__scopeId","data-v-ffb59fe0"]]);export{Oe as default};
