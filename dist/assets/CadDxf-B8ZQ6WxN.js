import{F as j,i as q}from"./three-C9DdkaV9.js";import{c as J,g as Z}from"./_commonjsHelpers-BosuxZz1.js";import{d as U,r as R,c as Y,e as G,D as I,w as V,g as M,ac as $}from"./index-Bsn8uhFR.js";import{E as Q}from"./index-NV_0FHae.js";import{E as ee}from"./index-BqWwdBzB.js";import"./error-DyDUhvQa.js";import"./_baseClone-BqSBTuLD.js";import"./isEqual-DLLu8dhP.js";class te{constructor(t){this._pointer=0,this._eof=!1,this._data=t}next(){if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);const t={code:parseInt(this._data[this._pointer])};return this._pointer++,t.value=B(t.code,this._data[this._pointer].trim()),this._pointer++,t.code===0&&t.value==="EOF"&&(this._eof=!0),this.lastReadGroup=t,t}peek(){if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);const t={code:parseInt(this._data[this._pointer])};return t.value=B(t.code,this._data[this._pointer+1].trim()),t}rewind(t=1){this._pointer=this._pointer-t*2}hasNext(){return!(this._eof||this._pointer>this._data.length-2)}isEOF(){return this._eof}}function B(i,t){return i<=9?t:i>=10&&i<=59?parseFloat(t):i>=60&&i<=99?parseInt(t):i>=100&&i<=109?t:i>=110&&i<=149?parseFloat(t):i>=160&&i<=179?parseInt(t):i>=210&&i<=239?parseFloat(t):i>=270&&i<=289?parseInt(t):i>=290&&i<=299?ae(t):i>=300&&i<=369?t:i>=370&&i<=389?parseInt(t):i>=390&&i<=399?t:i>=400&&i<=409?parseInt(t):i>=410&&i<=419?t:i>=420&&i<=429?parseInt(t):i>=430&&i<=439?t:i>=440&&i<=459?parseInt(t):i>=460&&i<=469?parseFloat(t):i>=470&&i<=481||i===999||i>=1e3&&i<=1009?t:i>=1010&&i<=1059?parseFloat(t):i>=1060&&i<=1071?parseInt(t):(console.log("WARNING: Group code does not have a defined type: %j",{code:i,value:t}),t)}function ae(i){if(i==="0")return!1;if(i==="1")return!0;throw TypeError("String '"+i+"' cannot be cast to Boolean type")}const z=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215];function ne(i){return z[i]}function b(i){const t={};i.rewind();let e=i.next(),a=e.code;if(t.x=e.value,a+=10,e=i.next(),e.code!=a)throw new Error("Expected code for point value to be "+a+" but got "+e.code+".");return t.y=e.value,a+=10,e=i.next(),e.code!=a?(i.rewind(),t):(t.z=e.value,t)}function g(i,t,e){switch(t.code){case 0:i.type=t.value;break;case 5:i.handle=t.value;break;case 6:i.lineType=t.value;break;case 8:i.layer=t.value;break;case 48:i.lineTypeScale=t.value;break;case 60:i.visible=t.value===0;break;case 62:i.colorIndex=t.value,i.color=ne(Math.abs(t.value));break;case 67:i.inPaperSpace=t.value!==0;break;case 100:break;case 101:for(;t.code!=0;)t=e.next();e.rewind();break;case 330:i.ownerHandle=t.value;break;case 347:i.materialObjectHandle=t.value;break;case 370:i.lineweight=t.value;break;case 420:i.color=t.value;break;case 1e3:i.extendedData=i.extendedData||{},i.extendedData.customStrings=i.extendedData.customStrings||[],i.extendedData.customStrings.push(t.value);break;case 1001:i.extendedData=i.extendedData||{},i.extendedData.applicationName=t.value;break;default:return!1}return!0}class ie{constructor(){this.ForEntityName="3DFACE"}parseEntity(t,e){const a={type:e.value,vertices:[]};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 70:a.shape=(e.value&1)===1,a.hasContinuousLinetypePattern=(e.value&128)===128;break;case 10:a.vertices=le(t,e),e=t.lastReadGroup;break;default:g(a,e,t);break}e=t.next()}return a}}function le(i,t){var e=[],a=!1,u=!1,l=4;for(let n=0;n<=l;n++){for(var c={};!i.isEOF()&&!(t.code===0||u);){switch(t.code){case 10:case 11:case 12:case 13:if(a){u=!0;continue}c.x=t.value,a=!0;break;case 20:case 21:case 22:case 23:c.y=t.value;break;case 30:case 31:case 32:case 33:c.z=t.value;break;default:return e}t=i.next()}e.push(c),a=!1,u=!1}return i.rewind(),e}class se{constructor(){this.ForEntityName="ARC"}parseEntity(t,e){const a={type:e.value};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 10:a.center=b(t);break;case 40:a.radius=e.value;break;case 50:a.startAngle=Math.PI/180*e.value;break;case 51:a.endAngle=Math.PI/180*e.value,a.angleLength=a.endAngle-a.startAngle;break;case 210:a.extrusionDirectionX=e.value;break;case 220:a.extrusionDirectionY=e.value;break;case 230:a.extrusionDirectionZ=e.value;break;default:g(a,e,t);break}e=t.next()}return a}}class oe{constructor(){this.ForEntityName="ATTDEF"}parseEntity(t,e){var a={type:e.value,scale:1,textStyle:"STANDARD"};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 1:a.text=e.value;break;case 2:a.tag=e.value;break;case 3:a.prompt=e.value;break;case 7:a.textStyle=e.value;break;case 10:a.startPoint=b(t);break;case 11:a.endPoint=b(t);break;case 39:a.thickness=e.value;break;case 40:a.textHeight=e.value;break;case 41:a.scale=e.value;break;case 50:a.rotation=e.value;break;case 51:a.obliqueAngle=e.value;break;case 70:a.invisible=!!(e.value&1),a.constant=!!(e.value&2),a.verificationRequired=!!(e.value&4),a.preset=!!(e.value&8);break;case 71:a.backwards=!!(e.value&2),a.mirrored=!!(e.value&4);break;case 72:a.horizontalJustification=e.value;break;case 73:a.fieldLength=e.value;break;case 74:a.verticalJustification=e.value;break;case 100:break;case 210:a.extrusionDirectionX=e.value;break;case 220:a.extrusionDirectionY=e.value;break;case 230:a.extrusionDirectionZ=e.value;break;default:g(a,e,t);break}e=t.next()}return a}}class re{constructor(){this.ForEntityName="CIRCLE"}parseEntity(t,e){const a={type:e.value};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 10:a.center=b(t);break;case 40:a.radius=e.value;break;case 50:a.startAngle=Math.PI/180*e.value;break;case 51:const u=Math.PI/180*e.value;u<a.startAngle?a.angleLength=u+2*Math.PI-a.startAngle:a.angleLength=u-a.startAngle,a.endAngle=u;break;default:g(a,e,t);break}e=t.next()}return a}}class ue{constructor(){this.ForEntityName="DIMENSION"}parseEntity(t,e){const a={type:e.value};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 2:a.block=e.value;break;case 10:a.anchorPoint=b(t);break;case 11:a.middleOfText=b(t);break;case 12:a.insertionPoint=b(t);break;case 13:a.linearOrAngularPoint1=b(t);break;case 14:a.linearOrAngularPoint2=b(t);break;case 15:a.diameterOrRadiusPoint=b(t);break;case 16:a.arcPoint=b(t);break;case 70:a.dimensionType=e.value;break;case 71:a.attachmentPoint=e.value;break;case 42:a.actualMeasurement=e.value;break;case 1:a.text=e.value;break;case 50:a.angle=e.value;break;default:g(a,e,t);break}e=t.next()}return a}}class fe{constructor(){this.ForEntityName="ELLIPSE"}parseEntity(t,e){const a={type:e.value};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 10:a.center=b(t);break;case 11:a.majorAxisEndPoint=b(t);break;case 40:a.axisRatio=e.value;break;case 41:a.startAngle=e.value;break;case 42:a.endAngle=e.value;break;case 2:a.name=e.value;break;default:g(a,e,t);break}e=t.next()}return a}}class be{constructor(){this.ForEntityName="INSERT"}parseEntity(t,e){const a={type:e.value};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 2:a.name=e.value;break;case 41:a.xScale=e.value;break;case 42:a.yScale=e.value;break;case 43:a.zScale=e.value;break;case 10:a.position=b(t);break;case 50:a.rotation=e.value;break;case 70:a.columnCount=e.value;break;case 71:a.rowCount=e.value;break;case 44:a.columnSpacing=e.value;break;case 45:a.rowSpacing=e.value;break;case 210:a.extrusionDirection=b(t);break;default:g(a,e,t);break}e=t.next()}return a}}class ce{constructor(){this.ForEntityName="LINE"}parseEntity(t,e){const a={type:e.value,vertices:[]};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 10:a.vertices.unshift(b(t));break;case 11:a.vertices.push(b(t));break;case 210:a.extrusionDirection=b(t);break;case 100:break;default:g(a,e,t);break}e=t.next()}return a}}class de{constructor(){this.ForEntityName="LWPOLYLINE"}parseEntity(t,e){const a={type:e.value,vertices:[]};let u=0;for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 38:a.elevation=e.value;break;case 39:a.depth=e.value;break;case 70:a.shape=(e.value&1)===1,a.hasContinuousLinetypePattern=(e.value&128)===128;break;case 90:u=e.value;break;case 10:a.vertices=ve(u,t);break;case 43:e.value!==0&&(a.width=e.value);break;case 210:a.extrusionDirectionX=e.value;break;case 220:a.extrusionDirectionY=e.value;break;case 230:a.extrusionDirectionZ=e.value;break;default:g(a,e,t);break}e=t.next()}return a}}function ve(i,t){if(!i||i<=0)throw Error("n must be greater than 0 verticies");const e=[];let a=!1,u=!1,l=t.lastReadGroup;for(let c=0;c<i;c++){const n={};for(;!t.isEOF()&&!(l.code===0||u);){switch(l.code){case 10:if(a){u=!0;continue}n.x=l.value,a=!0;break;case 20:n.y=l.value;break;case 30:n.z=l.value;break;case 40:n.startWidth=l.value;break;case 41:n.endWidth=l.value;break;case 42:l.value!=0&&(n.bulge=l.value);break;default:return t.rewind(),a&&e.push(n),t.rewind(),e}l=t.next()}e.push(n),a=!1,u=!1}return t.rewind(),e}class pe{constructor(){this.ForEntityName="MTEXT"}parseEntity(t,e){const a={type:e.value};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 3:a.text?a.text+=e.value:a.text=e.value;break;case 1:a.text?a.text+=e.value:a.text=e.value;break;case 10:a.position=b(t);break;case 11:a.directionVector=b(t);break;case 40:a.height=e.value;break;case 41:a.width=e.value;break;case 50:a.rotation=e.value;break;case 71:a.attachmentPoint=e.value;break;case 72:a.drawingDirection=e.value;break;default:g(a,e,t);break}e=t.next()}return a}}class ke{constructor(){this.ForEntityName="POINT"}parseEntity(t,e){const u={type:e.value};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 10:u.position=b(t);break;case 39:u.thickness=e.value;break;case 210:u.extrusionDirection=b(t);break;case 100:break;default:g(u,e,t);break}e=t.next()}return u}}class he{constructor(){this.ForEntityName="VERTEX"}parseEntity(t,e){var a={type:e.value};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 10:a.x=e.value;break;case 20:a.y=e.value;break;case 30:a.z=e.value;break;case 40:break;case 41:break;case 42:e.value!=0&&(a.bulge=e.value);break;case 70:a.curveFittingVertex=(e.value&1)!==0,a.curveFitTangent=(e.value&2)!==0,a.splineVertex=(e.value&8)!==0,a.splineControlPoint=(e.value&16)!==0,a.threeDPolylineVertex=(e.value&32)!==0,a.threeDPolylineMesh=(e.value&64)!==0,a.polyfaceMeshVertex=(e.value&128)!==0;break;case 50:break;case 71:a.faceA=e.value;break;case 72:a.faceB=e.value;break;case 73:a.faceC=e.value;break;case 74:a.faceD=e.value;break;default:g(a,e,t);break}e=t.next()}return a}}class ge{constructor(){this.ForEntityName="POLYLINE"}parseEntity(t,e){var a={type:e.value,vertices:[]};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 10:break;case 20:break;case 30:break;case 39:a.thickness=e.value;break;case 40:break;case 41:break;case 70:a.shape=(e.value&1)!==0,a.includesCurveFitVertices=(e.value&2)!==0,a.includesSplineFitVertices=(e.value&4)!==0,a.is3dPolyline=(e.value&8)!==0,a.is3dPolygonMesh=(e.value&16)!==0,a.is3dPolygonMeshClosed=(e.value&32)!==0,a.isPolyfaceMesh=(e.value&64)!==0,a.hasContinuousLinetypePattern=(e.value&128)!==0;break;case 71:break;case 72:break;case 73:break;case 74:break;case 75:break;case 210:a.extrusionDirection=b(t);break;default:g(a,e,t);break}e=t.next()}return a.vertices=xe(t,e),a}}function xe(i,t){const e=new he,a=[];for(;!i.isEOF();)if(t.code===0){if(t.value==="VERTEX")a.push(e.parseEntity(i,t)),t=i.lastReadGroup;else if(t.value==="SEQEND"){ye(i,t);break}}return a}function ye(i,t){const e={type:t.value};for(t=i.next();!i.isEOF()&&t.code!=0;)g(e,t,i),t=i.next();return e}class Ee{constructor(){this.ForEntityName="SOLID"}parseEntity(t,e){const a={type:e.value,points:[]};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 10:a.points[0]=b(t);break;case 11:a.points[1]=b(t);break;case 12:a.points[2]=b(t);break;case 13:a.points[3]=b(t);break;case 210:a.extrusionDirection=b(t);break;default:g(a,e,t);break}e=t.next()}return a}}class we{constructor(){this.ForEntityName="SPLINE"}parseEntity(t,e){const a={type:e.value};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 10:a.controlPoints||(a.controlPoints=[]),a.controlPoints.push(b(t));break;case 11:a.fitPoints||(a.fitPoints=[]),a.fitPoints.push(b(t));break;case 12:a.startTangent=b(t);break;case 13:a.endTangent=b(t);break;case 40:a.knotValues||(a.knotValues=[]),a.knotValues.push(e.value);break;case 70:e.value&1&&(a.closed=!0),e.value&2&&(a.periodic=!0),e.value&4&&(a.rational=!0),e.value&8&&(a.planar=!0),e.value&16&&(a.planar=!0,a.linear=!0);break;case 71:a.degreeOfSplineCurve=e.value;break;case 72:a.numberOfKnots=e.value;break;case 73:a.numberOfControlPoints=e.value;break;case 74:a.numberOfFitPoints=e.value;break;case 210:a.normalVector=b(t);break;default:g(a,e,t);break}e=t.next()}return a}}class me{constructor(){this.ForEntityName="TEXT"}parseEntity(t,e){const a={type:e.value};for(e=t.next();!t.isEOF()&&e.code!==0;){switch(e.code){case 10:a.startPoint=b(t);break;case 11:a.endPoint=b(t);break;case 40:a.textHeight=e.value;break;case 41:a.xScale=e.value;break;case 50:a.rotation=e.value;break;case 1:a.text=e.value;break;case 72:a.halign=e.value;break;case 73:a.valign=e.value;break;default:g(a,e,t);break}e=t.next()}return a}}var W={exports:{}};(function(i){(function(t,e){i.exports?i.exports=e():t.log=e()})(J,function(){var t=function(){},e="undefined",a=typeof window!==e&&typeof window.navigator!==e&&/Trident\/|MSIE /.test(window.navigator.userAgent),u=["trace","debug","info","warn","error"],l={},c=null;function n(v,h){var r=v[h];if(typeof r.bind=="function")return r.bind(v);try{return Function.prototype.bind.call(r,v)}catch{return function(){return Function.prototype.apply.apply(r,[v,arguments])}}}function N(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function O(v){return v==="debug"&&(v="log"),typeof console===e?!1:v==="trace"&&a?N:console[v]!==void 0?n(console,v):console.log!==void 0?n(console,"log"):t}function L(){for(var v=this.getLevel(),h=0;h<u.length;h++){var r=u[h];this[r]=h<v?t:this.methodFactory(r,v,this.name)}if(this.log=this.debug,typeof console===e&&v<this.levels.SILENT)return"No console available for logging"}function _(v){return function(){typeof console!==e&&(L.call(this),this[v].apply(this,arguments))}}function A(v,h,r){return O(v)||_.apply(this,arguments)}function P(v,h){var r=this,F,D,k,E="loglevel";typeof v=="string"?E+=":"+v:typeof v=="symbol"&&(E=void 0);function o(p){var y=(u[p]||"silent").toUpperCase();if(!(typeof window===e||!E)){try{window.localStorage[E]=y;return}catch{}try{window.document.cookie=encodeURIComponent(E)+"="+y+";"}catch{}}}function s(){var p;if(!(typeof window===e||!E)){try{p=window.localStorage[E]}catch{}if(typeof p===e)try{var y=window.document.cookie,S=encodeURIComponent(E),H=y.indexOf(S+"=");H!==-1&&(p=/^([^;]+)/.exec(y.slice(H+S.length+1))[1])}catch{}return r.levels[p]===void 0&&(p=void 0),p}}function d(){if(!(typeof window===e||!E)){try{window.localStorage.removeItem(E)}catch{}try{window.document.cookie=encodeURIComponent(E)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function x(p){var y=p;if(typeof y=="string"&&r.levels[y.toUpperCase()]!==void 0&&(y=r.levels[y.toUpperCase()]),typeof y=="number"&&y>=0&&y<=r.levels.SILENT)return y;throw new TypeError("log.setLevel() called with invalid level: "+p)}r.name=v,r.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},r.methodFactory=h||A,r.getLevel=function(){return k??D??F},r.setLevel=function(p,y){return k=x(p),y!==!1&&o(k),L.call(r)},r.setDefaultLevel=function(p){D=x(p),s()||r.setLevel(p,!1)},r.resetLevel=function(){k=null,d(),L.call(r)},r.enableAll=function(p){r.setLevel(r.levels.TRACE,p)},r.disableAll=function(p){r.setLevel(r.levels.SILENT,p)},r.rebuild=function(){if(c!==r&&(F=x(c.getLevel())),L.call(r),c===r)for(var p in l)l[p].rebuild()},F=x(c?c.getLevel():"WARN");var w=s();w!=null&&(k=x(w)),L.call(r)}c=new P,c.getLogger=function(h){if(typeof h!="symbol"&&typeof h!="string"||h==="")throw new TypeError("You must supply a name when creating a logger.");var r=l[h];return r||(r=l[h]=new P(h,c.methodFactory)),r};var C=typeof window!==e?window.log:void 0;return c.noConflict=function(){return typeof window!==e&&window.log===c&&(window.log=C),c},c.getLoggers=function(){return l},c.default=c,c})})(W);var Le=W.exports;const f=Z(Le);f.setLevel("error");function Fe(i){i.registerEntityHandler(ie),i.registerEntityHandler(se),i.registerEntityHandler(oe),i.registerEntityHandler(re),i.registerEntityHandler(ue),i.registerEntityHandler(fe),i.registerEntityHandler(be),i.registerEntityHandler(ce),i.registerEntityHandler(de),i.registerEntityHandler(pe),i.registerEntityHandler(ke),i.registerEntityHandler(ge),i.registerEntityHandler(Ee),i.registerEntityHandler(we),i.registerEntityHandler(me)}class Te{constructor(){this._entityHandlers={},Fe(this)}parse(t){return typeof t=="string"?this._parse(t):(console.error("Cannot read dxf source of type `"+typeof t),null)}registerEntityHandler(t){const e=new t;this._entityHandlers[e.ForEntityName]=e}parseSync(t){return this.parse(t)}parseStream(t){let e="";const a=this;return new Promise((u,l)=>{t.on("data",c=>{e+=c}),t.on("end",()=>{try{u(a._parse(e))}catch(c){l(c)}}),t.on("error",c=>{l(c)})})}_parse(t){const e={};let a=0;const u=t.split(/\r\n|\r|\n/g),l=new te(u);if(!l.hasNext())throw Error("Empty file");const c=this;let n;function N(){for(n=l.next();!l.isEOF();)if(n.code===0&&n.value==="SECTION"){if(n=l.next(),n.code!==2){console.error("Unexpected code %s after 0:SECTION",X(n)),n=l.next();continue}n.value==="HEADER"?(f.debug("> HEADER"),e.header=O(),f.debug("<")):n.value==="BLOCKS"?(f.debug("> BLOCKS"),e.blocks=L(),f.debug("<")):n.value==="ENTITIES"?(f.debug("> ENTITIES"),e.entities=D(!1),f.debug("<")):n.value==="TABLES"?(f.debug("> TABLES"),e.tables=A(),f.debug("<")):n.value==="EOF"?f.debug("EOF"):f.warn("Skipping section '%s'",n.value)}else n=l.next()}function O(){let o=null,s=null;const d={};for(n=l.next();;){if(m(n,0,"ENDSEC")){o&&(d[o]=s);break}else n.code===9?(o&&(d[o]=s),o=n.value):n.code===10?s={x:n.value}:n.code===20?s.y=n.value:n.code===30?s.z=n.value:s=n.value;n=l.next()}return n=l.next(),d}function L(){const o={};for(n=l.next();n.value!=="EOF"&&!m(n,0,"ENDSEC");)if(m(n,0,"BLOCK")){f.debug("block {");const s=_();f.debug("}"),E(s),s.name?o[s.name]=s:f.error('block with handle "'+s.handle+'" is missing a name.')}else T(n),n=l.next();return o}function _(){const o={};for(n=l.next();n.value!=="EOF";){switch(n.code){case 1:o.xrefPath=n.value,n=l.next();break;case 2:o.name=n.value,n=l.next();break;case 3:o.name2=n.value,n=l.next();break;case 5:o.handle=n.value,n=l.next();break;case 8:o.layer=n.value,n=l.next();break;case 10:o.position=k(n),n=l.next();break;case 67:o.paperSpace=!!(n.value&&n.value==1),n=l.next();break;case 70:n.value!=0&&(o.type=n.value),n=l.next();break;case 100:n=l.next();break;case 330:o.ownerHandle=n.value,n=l.next();break;case 0:if(n.value=="ENDBLK")break;o.entities=D(!0);break;default:T(n),n=l.next()}if(m(n,0,"ENDBLK")){n=l.next();break}}return o}function A(){const o={};for(n=l.next();n.value!=="EOF"&&!m(n,0,"ENDSEC");)m(n,0,"TABLE")?(n=l.next(),F[n.value]?(f.debug(n.value+" Table {"),o[F[n.value].tableName]=C(n),f.debug("}")):f.debug("Unhandled Table "+n.value)):n=l.next();return n=l.next(),o}const P="ENDTAB";function C(o){const s=F[o.value],d={};let x=0;for(n=l.next();!m(n,0,P);)switch(n.code){case 5:d.handle=n.value,n=l.next();break;case 330:d.ownerHandle=n.value,n=l.next();break;case 100:n.value==="AcDbSymbolTable"||T(n),n=l.next();break;case 70:x=n.value,n=l.next();break;case 0:n.value===s.dxfSymbolName?d[s.tableRecordsProperty]=s.parseTableRecords():(T(n),n=l.next());break;default:T(n),n=l.next()}const w=d[s.tableRecordsProperty];if(w){let p=(()=>{if(w.constructor===Array)return w.length;if(typeof w=="object")return Object.keys(w).length})();x!==p&&f.warn("Parsed "+p+" "+s.dxfSymbolName+"'s but expected "+x)}return n=l.next(),d}function v(){const o=[];let s={};for(f.debug("ViewPort {"),n=l.next();!m(n,0,P);)switch(n.code){case 2:s.name=n.value,n=l.next();break;case 10:s.lowerLeftCorner=k(n),n=l.next();break;case 11:s.upperRightCorner=k(n),n=l.next();break;case 12:s.center=k(n),n=l.next();break;case 13:s.snapBasePoint=k(n),n=l.next();break;case 14:s.snapSpacing=k(n),n=l.next();break;case 15:s.gridSpacing=k(n),n=l.next();break;case 16:s.viewDirectionFromTarget=k(n),n=l.next();break;case 17:s.viewTarget=k(n),n=l.next();break;case 42:s.lensLength=n.value,n=l.next();break;case 43:s.frontClippingPlane=n.value,n=l.next();break;case 44:s.backClippingPlane=n.value,n=l.next();break;case 45:s.viewHeight=n.value,n=l.next();break;case 50:s.snapRotationAngle=n.value,n=l.next();break;case 51:s.viewTwistAngle=n.value,n=l.next();break;case 79:s.orthographicType=n.value,n=l.next();break;case 110:s.ucsOrigin=k(n),n=l.next();break;case 111:s.ucsXAxis=k(n),n=l.next();break;case 112:s.ucsYAxis=k(n),n=l.next();break;case 110:s.ucsOrigin=k(n),n=l.next();break;case 281:s.renderMode=n.value,n=l.next();break;case 281:s.defaultLightingType=n.value,n=l.next();break;case 292:s.defaultLightingOn=n.value,n=l.next();break;case 330:s.ownerHandle=n.value,n=l.next();break;case 63:case 421:case 431:s.ambientColor=n.value,n=l.next();break;case 0:n.value==="VPORT"&&(f.debug("}"),o.push(s),f.debug("ViewPort {"),s={},n=l.next());break;default:T(n),n=l.next();break}return f.debug("}"),o.push(s),o}function h(){const o={};let s={},d=0,x;for(f.debug("LType {"),n=l.next();!m(n,0,"ENDTAB");)switch(n.code){case 2:s.name=n.value,x=n.value,n=l.next();break;case 3:s.description=n.value,n=l.next();break;case 73:d=n.value,d>0&&(s.pattern=[]),n=l.next();break;case 40:s.patternLength=n.value,n=l.next();break;case 49:s.pattern.push(n.value),n=l.next();break;case 0:f.debug("}"),d>0&&d!==s.pattern.length&&f.warn("lengths do not match on LTYPE pattern"),o[x]=s,s={},f.debug("LType {"),n=l.next();break;default:n=l.next()}return f.debug("}"),o[x]=s,o}function r(){const o={};let s={},d;for(f.debug("Layer {"),n=l.next();!m(n,0,"ENDTAB");)switch(n.code){case 2:s.name=n.value,d=n.value,n=l.next();break;case 62:s.visible=n.value>=0,s.colorIndex=Math.abs(n.value),s.color=Ne(s.colorIndex),n=l.next();break;case 70:s.frozen=(n.value&1)!=0||(n.value&2)!=0,n=l.next();break;case 0:n.value==="LAYER"&&(f.debug("}"),o[d]=s,f.debug("Layer {"),s={},d=void 0,n=l.next());break;default:T(n),n=l.next();break}return f.debug("}"),o[d]=s,o}const F={VPORT:{tableRecordsProperty:"viewPorts",tableName:"viewPort",dxfSymbolName:"VPORT",parseTableRecords:v},LTYPE:{tableRecordsProperty:"lineTypes",tableName:"lineType",dxfSymbolName:"LTYPE",parseTableRecords:h},LAYER:{tableRecordsProperty:"layers",tableName:"layer",dxfSymbolName:"LAYER",parseTableRecords:r}};function D(o){const s=[],d=o?"ENDBLK":"ENDSEC";for(o||(n=l.next());;)if(n.code===0){if(n.value===d)break;const x=c._entityHandlers[n.value];if(x!=null){f.debug(n.value+" {");const w=x.parseEntity(l,n);n=l.lastReadGroup,f.debug("}"),E(w),s.push(w)}else{f.warn("Unhandled entity "+n.value),n=l.next();continue}}else n=l.next();return d=="ENDSEC"&&(n=l.next()),s}function k(o){const s={};let d=o.code;if(s.x=o.value,d+=10,o=l.next(),o.code!=d)throw new Error("Expected code for point value to be "+d+" but got "+o.code+".");return s.y=o.value,d+=10,o=l.next(),o.code!=d?(l.rewind(),s):(s.z=o.value,s)}function E(o){if(!o)throw new TypeError("entity cannot be undefined or null");o.handle||(o.handle=a++)}return N(),e}}function m(i,t,e){return i.code===t&&i.value===e}function T(i){f.debug("unhandled group "+X(i))}function X(i){return i.code+":"+i.value}function Ne(i){return z[i]}const De=""+new URL("YaHei_Regular-DUYW1GNG.json",import.meta.url).href,Oe=U({__name:"SytDxf",setup(i,{expose:t}){const e=R(),a=new Te,u=new j;let l=R();return u.load(De,function(n){l.value=n}),t({initDxf:(n,N,O)=>{var L=a.parseSync(n);e.value.innerHTML="",new q(L,e.value,N,O,l.value)}}),(n,N)=>(Y(),G("div",{ref_key:"cadViewRef",ref:e},null,512))}}),Ve=U({__name:"CadDxf",setup(i){const t=R(),e=(a,u)=>{u.length=0,u.push(a);var l=new FileReader;l.onloadend=c=>{var n=c.target;if(n.error)return console.log("error onloadend!?");t.value.initDxf(n.result,800,600)},l.readAsText(a.raw,"UTF-8")};return(a,u)=>(Y(),G("div",null,[I(M(ee),{"on-change":e,"auto-upload":!1},{default:V(()=>[I(M(Q),{plain:"",type:"primary"},{default:V(()=>[$("选择dxf文件")]),_:1})]),_:1}),I(Oe,{ref_key:"dxfRef",ref:t},null,512)]))}});export{Ve as default};
