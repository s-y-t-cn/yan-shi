import{r as R,N as ee,o as te,ap as ae,c as U,e as $,z as oe,d as ne,ah as re,aq as se,D as v,w as T,g as z,ac as le}from"./index-Bsn8uhFR.js";import{E as ie}from"./el-card-P9uYmptO.js";/* empty css               */import{S as ce,P as pe,W as me,O as de,A as he,a as ue,G as I,b as N,E as G,M as fe,c as V,d as we,T as ge,e as be,f as xe,B as Se,V as D,L as ve,g as ye,h as _e}from"./three-C9DdkaV9.js";import{f as Me,c as F}from"./modules-ClEp93Bn.js";import{E as Ee}from"./index-C-Yt4Yjn.js";import"./index-f9LhncNo.js";import"./error-DyDUhvQa.js";import"./index-NV_0FHae.js";import"./index-B9r6-Uhw.js";import"./castArray-dThNn2ng.js";import"./index-DgBkyx5Q.js";import"./index-BW8njkrs.js";import"./index-li2vGeyt.js";import"./index-DFENW1vO.js";import"./index-WB42fc2K.js";import"./_baseClone-BqSBTuLD.js";import"./index-qZKloEJB.js";import"./isEqual-DLLu8dhP.js";import"./index-Cc46_B1g.js";import"./index-C73im1hn.js";import"./index-C2ioxsOw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-j6jngLIj.js";import"./index-9zNjbeCL.js";import"./index-Cs2G8_c2.js";import"./dropdown-Biev14ov.js";import"./_commonjsHelpers-BosuxZz1.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const E=10,Pe={__name:"SytPieChart",props:{width:[String,Number],height:[String,Number],params:{type:Object,default(){return{radius:5,data:[{label:"",value:0,color:"#fff"}]}}}},setup(f){const w=R(),e=f,o=new ce,l=new pe(75,e.width/e.height,.1,1e3),p=new me({antialias:!0,alpha:!0}),y=new de(l,p.domElement);y.autoRotate=!0;const _=new he(5263440);o.add(_);const m=new ue(16777215,10,32,3);m.position.set(0,15,5),m.castShadow=!0,o.add(m),p.setSize(e.width,e.height),l.position.set(5,15,12);let n=new I,P=e.params.data.reduce((t,r)=>t+=r.value,0),d=0,j=10;const X=t=>{let r=t.value/P,h=Math.PI*2*r+d,i=j*r;i<1&&(i=1);const s=new N;s.absarc(0,0,E,d,h),s.absarc(0,0,e.params.radius,h,d,!0);const u={steps:2,depth:i,bevelEnabled:!1};let c=t.color??`#${Math.random().toString().slice(2,8)}`;const q=new G(s,u),W=new we({color:c,transparent:!0,opacity:.8,emissive:c,emissiveIntensity:.3}),M=new V(q,W);M.castShadow=!0,n.add(M),d=h;let g=document.createElement("canvas");g.setAttribute("width","100"),g.setAttribute("height","100");let a=g.getContext("2d");a.font="15px math",a.textAlign="center",a.strokeStyle="#fff",a.fillStyle="rgba(65, 165, 251, 1)",a.textBaseline="bottom",a.fillText(t.label,50,89),a.font="13px math",a.strokeStyle="#f00",a.fillStyle=c,a.textBaseline="bottom",a.fillText(t.value,50,100),a.measureText(t.label);const J=new ge().load(g.toDataURL()),k=new be({map:J});k.sizeAttenuation=!1;const b=new xe(k);b.scale.set(.6,.6,.6),b.center.set(.5,0);let B=new Se().setFromObject(M).getCenter(new D),x=B.clone();x.z=i+3;const H=new ve({color:c,linewidth:2});let K=5,Q=x.clone().projectOnPlane(new D(0,0,1)).normalize(),O=x.clone().addScaledVector(Q,K);const S=[];S.push(B),S.push(x),S.push(O);const Y=new ye().setFromPoints(S),Z=new _e(Y,H);n.add(Z),b.position.copy(O),n.add(b)},C=()=>{o.remove(n),n=new I,P=e.params.data.reduce((u,c)=>u+=c.value,0),d=0;const t=new N;t.absarc(0,0,E+1,0,Math.PI),t.absarc(0,0,E+1,Math.PI,0);const r={steps:2,depth:.5,bevelEnabled:!1},h=new G(t,r),i=new fe({color:"#155a81"}),s=new V(h,i);s.castShadow=!0,s.position.z=-1,n.add(s),n.rotateX(-Math.PI/2),o.add(n),e.params.data.forEach(u=>X(u))};let L=null;const A=()=>{L=requestAnimationFrame(A),y.update(),p.render(o,l)};return ee(()=>e.params.data,()=>{C()},{deep:!0}),te(()=>{w.value.appendChild(p.domElement),C(),A()}),ae(()=>{cancelAnimationFrame(L)}),(t,r)=>(U(),$("div",{ref_key:"container",ref:w,style:oe({width:`${f.width}px`,height:`${f.height}px`})},null,4))}},ot=ne({__name:"index",setup(f){F.baseUrl="http://localhost:8080",F.token=re().token;let w=R({radius:5,data:[{label:"好家庭",value:10,color:"#40abc7"},{label:"好张三",value:2,color:"#f29754"},{label:"好职工",value:4,color:"#f5bb4f"},{label:"好商户",value:6,color:"#8ecff0"},{label:"好李四",value:8}]});const e=se();let o;const l=localStorage.getItem("SytPage");return l&&(e.value=Me(l),o=e.value.component),(p,y)=>{const _=Ee,m=ie;return U(),$("div",null,[v(_,{type:"info",effect:"dark"},{default:T(()=>[le("由低代码页面编辑器生成")]),_:1}),v(z(o)),v(m,{style:{width:"540px"}},{default:T(()=>[v(Pe,{width:"500",height:"400",params:z(w)},null,8,["params"])]),_:1})])}}});export{ot as default};
