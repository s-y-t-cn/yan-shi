import{d as E,r as f,a0 as w,l as y,w as l,aV as V,ae as v,c as x,B as a,g,aa as P,af as b,am as F,bT as R,aj as S}from"./index-BJnXyKVp.js";/* empty css                     *//* empty css                  *//* empty css                 */import{r as U}from"./auth-Ch5KONFg.js";import{u as h}from"./menus-Dy1wEj9W.js";import{h as B}from"./index-DIjjrsno.js";import{a as C,E as M}from"./index-ICkUlJyf.js";import{E as q}from"./index-XTd2ODOz.js";import{E as N}from"./index-BiJnfdqe.js";const G=E({__name:"Regist",setup($){const _=v(),p=f();let n=f(!1);const s=w({username:"",password:"",repeatPassword:"",verifyCode:""}),c=w({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,validator:(u,e,r)=>{e===""?r(new Error("请输入密码")):/^(?=.*\d)(?=.*[A-Za-z]).{6,}$/.test(e)?r():r(new Error("密码最少6位并包含字母和数字"))},trigger:"blur"}],repeatPassword:[{required:!0,validator:(u,e,r)=>{e===""?r(new Error("请输入确认密码")):e!=s.password?r(new Error("两次密码不一致")):r()},trigger:"blur"}]}),m=u=>{u&&(n.value=!0,u.validate(async e=>{if(e){let r=Object.assign({},s);Reflect.deleteProperty(r,"repeatPassword"),r.password=await B(r.password),U(r).then(async o=>{if(o.code===200){const i=o.data;b().login(i),await F().initRoles(),await R().then(d=>{d.code===200&&h().SAVE_MENUS(d.data)}),S({type:"success",message:"注册成功"}),_.push("/")}else n.value=!1})}else n.value=!1,console.log("验证失败!")}))};return(u,e)=>{const r=q,o=M,i=N,d=C;return x(),y(d,{ref_key:"ruleFormRef",ref:p,model:s,rules:c,size:"large",class:"w-full",onKeydown:e[4]||(e[4]=V(t=>m(p.value),["enter"]))},{default:l(()=>[a(o,{prop:"username"},{default:l(()=>[a(r,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=t=>s.username=t),placeholder:"用户名","prefix-icon":"user"},null,8,["modelValue"])]),_:1}),a(o,{prop:"password"},{default:l(()=>[a(r,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=t=>s.password=t),type:"password",placeholder:"密码","prefix-icon":"lock","show-password":""},null,8,["modelValue"])]),_:1}),a(o,{prop:"repeatPassword"},{default:l(()=>[a(r,{modelValue:s.repeatPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>s.repeatPassword=t),type:"password",placeholder:"确认密码","prefix-icon":"lock","show-password":""},null,8,["modelValue"])]),_:1}),a(o,null,{default:l(()=>[a(i,{class:"w-full",type:"primary",loading:g(n),disabled:g(n),onClick:e[3]||(e[3]=t=>m(p.value))},{default:l(()=>[P(" 注册 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model","rules"])}}});export{G as _};
