import{d as E,r as f,a2 as w,l as y,w as l,aL as V,ag as v,c as x,D as a,g,ac as P,ah as b,ao as F,bL as R,al as h}from"./index-B_ZJlzGL.js";/* empty css                     *//* empty css                  *//* empty css                 */import{r as S}from"./auth-CxwrUTjV.js";import{u as U}from"./menus-CiB-a3CU.js";import{h as C}from"./index-DIjjrsno.js";import{a as M,E as q}from"./index-hpsKijdF.js";import{E as B}from"./index-BBE6lv8d.js";import{E as N}from"./index-BU1K9O-H.js";const Z=E({__name:"Regist",setup($){const c=v(),p=f();let n=f(!1);const s=w({username:"",password:"",repeatPassword:"",verifyCode:""}),_=w({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,validator:(u,e,r)=>{e===""?r(new Error("请输入密码")):/^(?=.*\d)(?=.*[A-Za-z]).{6,}$/.test(e)?r():r(new Error("密码最少6位并包含字母和数字"))},trigger:"blur"}],repeatPassword:[{required:!0,validator:(u,e,r)=>{e===""?r(new Error("请输入确认密码")):e!=s.password?r(new Error("两次密码不一致")):r()},trigger:"blur"}]}),m=u=>{u&&(n.value=!0,u.validate(async e=>{if(e){let r=Object.assign({},s);Reflect.deleteProperty(r,"repeatPassword"),r.password=await C(r.password),S(r).then(async o=>{if(o.code===200){const i=o.data;b().login(i),await F().initRoles(),await R().then(d=>{d.code===200&&U().SAVE_MENUS(d.data)}),h({type:"success",message:"注册成功"}),c.push("/")}else n.value=!1})}else n.value=!1,console.log("验证失败!")}))};return(u,e)=>{const r=B,o=q,i=N,d=M;return x(),y(d,{ref_key:"ruleFormRef",ref:p,model:s,rules:_,size:"large",class:"w-full",onKeydown:e[4]||(e[4]=V(t=>m(p.value),["enter"]))},{default:l(()=>[a(o,{prop:"username"},{default:l(()=>[a(r,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=t=>s.username=t),placeholder:"用户名","prefix-icon":"user"},null,8,["modelValue"])]),_:1}),a(o,{prop:"password"},{default:l(()=>[a(r,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=t=>s.password=t),type:"password",placeholder:"密码","prefix-icon":"lock","show-password":""},null,8,["modelValue"])]),_:1}),a(o,{prop:"repeatPassword"},{default:l(()=>[a(r,{modelValue:s.repeatPassword,"onUpdate:modelValue":e[2]||(e[2]=t=>s.repeatPassword=t),type:"password",placeholder:"确认密码","prefix-icon":"lock","show-password":""},null,8,["modelValue"])]),_:1}),a(o,null,{default:l(()=>[a(i,{class:"w-full",type:"primary",loading:g(n),disabled:g(n),onClick:e[3]||(e[3]=t=>m(p.value))},{default:l(()=>[P(" 注册 ")]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model","rules"])}}});export{Z as _};
