import{d as Q,r as i,o as W,N as h,c as p,e as V,k as G,B as t,w as n,aa as w,g as l,l as E,m as x,W as H,ac as J,ag as K,bP as X,bQ as C,bR as Y,bS as Z,bT as ee,aj as b,E as te,bU as oe,bV as le}from"./index-DIMNw_Zj.js";/* empty css                   *//* empty css                     *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  */import{a as ae}from"./el-checkbox-D1rcqvlA.js";/* empty css                       */import{E as ne}from"./el-popover-DF5ri7S4.js";/* empty css                 *//* empty css                  */import{u as se}from"./menus-BP1NBjo0.js";import{S as re}from"./SytTable-Djb2R500.js";import{E as ie}from"./index-XCTi-11Y.js";import{E as me}from"./index-CgNxFwXq.js";import{E as pe,a as de}from"./index-CT98zgnM.js";import{E as ue}from"./index-B9XYfkOM.js";import{E as ce}from"./index-Dz31jwcF.js";import{b as fe}from"./index-BRbOUH9G.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DXi_4jNA.js";import"./index-CtTxH7lL.js";import"./error-CA4BzyrB.js";import"./index-DDU8FhM7.js";import"./index-BORlPtjh.js";import"./castArray-BI0f9r0B.js";import"./scroll-BaQDGjHk.js";import"./isEqual-D4TRYkwQ.js";import"./_Uint8Array-CNXowefJ.js";import"./_baseIteratee-CsIwghsN.js";import"./index-Bdi75iBV.js";import"./index-pThFEOfU.js";import"./_initCloneObject-BKFhQqjC.js";import"./_baseClone-CkdOwu1U.js";import"./dropdown-Dqp4kvay.js";import"./vnode-BwmuWjnw.js";const ge={class:"container"},be={class:"tools"},ve={key:1,class:"icon-select-text"},Ve=Q({__name:"Menus",setup(Ee){const D=i([{title:"路由名",dataIndex:"name"},{title:"路由路径",dataIndex:"path"},{title:"组件路径",dataIndex:"component"},{title:"菜单名",dataIndex:"meta.title"},{title:"显示菜单",dataIndex:"meta.showLink"}]),I=se();let v=i([]),M=i(!0),m=i(!1),k=i(null),u=i("");const S=i({name:[{required:!0,message:"请输入路由名",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件路径",trigger:"blur"}],"meta.title":[{required:!0,message:"请输入菜单名",trigger:"blur"}],"meta.showLink":[{required:!0,message:"显示菜单",trigger:"change"}]});let y=()=>({pid:"",path:"",name:"",component:"",meta:{icon:"",title:"",showLink:!0}}),a=i(y());const c=async()=>{await X().then(s=>{s.code===200&&(s.data.forEach(e=>{var d;e.iconComponent=C[(d=e.meta)==null?void 0:d.icon]}),v.value=Y(s.data),I.SAVE_MENUS(s.data))}),M.value=!1},U=()=>{u.value="添加",m.value=!0,a.value=y()},B=s=>{u.value="编辑",m.value=!0,a.value=Z(s)},F=async()=>{let s=Object.assign({},a.value);oe(s).then(e=>{e.code==200&&(b({type:"success",message:"添加成功"}),c())})},L=async()=>{let s=Object.assign({},a.value);le(s).then(e=>{e.code==200&&(b({type:"success",message:"编辑成功"}),c())})},R=s=>{s._id?ee({_id:s._id}).then(e=>{e.code==200&&(b({type:"success",message:"删除成功"}),c())}):b({type:"error",message:"不存在的_id"})},T=s=>{s&&s.validate(e=>{e?(u.value==="添加"?F():L(),m.value=!1):console.log("验证失败!")})};return W(()=>{c()}),(s,e)=>{const d=ie,q=h("Edit"),f=te,N=h("Delete"),j=ne,_=me,r=pe,z=ue,O=ce,P=ae,$=de,A=fe;return p(),V("div",ge,[G("div",be,[t(d,{onClick:U},{default:n(()=>[w("添加菜单")]),_:1})]),t(re,{columns:D.value,data:l(v)},{operations:n(({row:o})=>[t(f,{class:"icon",color:"#0af",onClick:g=>B(o)},{default:n(()=>[t(q)]),_:2},1032,["onClick"]),t(j,{title:"确定删除?",onConfirm:g=>R(o)},{reference:n(()=>[t(f,{class:"icon",color:"#f00"},{default:n(()=>[t(N)]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["columns","data"]),t(A,{modelValue:l(m),"onUpdate:modelValue":e[7]||(e[7]=o=>K(m)?m.value=o:m=o),title:l(u),width:"350px"},{default:n(()=>[t($,{ref_key:"ruleFormRef",ref:k,model:l(a),rules:S.value,size:"large",class:"w-full","label-width":"auto"},{default:n(()=>[t(r,{label:"路由名",prop:"name"},{default:n(()=>[t(_,{modelValue:l(a).name,"onUpdate:modelValue":e[0]||(e[0]=o=>l(a).name=o),placeholder:"路由名"},null,8,["modelValue"])]),_:1}),t(r,{label:"路由路径",prop:"path"},{default:n(()=>[t(_,{modelValue:l(a).path,"onUpdate:modelValue":e[1]||(e[1]=o=>l(a).path=o),placeholder:"需包含上级菜单的路径"},null,8,["modelValue"])]),_:1}),t(r,{label:"组件路径",prop:"component"},{default:n(()=>[t(_,{modelValue:l(a).component,"onUpdate:modelValue":e[2]||(e[2]=o=>l(a).component=o),placeholder:"/src/views/**.vue"},null,8,["modelValue"])]),_:1}),t(r,{label:"菜单名",prop:"meta.title"},{default:n(()=>[t(_,{modelValue:l(a).meta.title,"onUpdate:modelValue":e[3]||(e[3]=o=>l(a).meta.title=o),placeholder:"菜单名"},null,8,["modelValue"])]),_:1}),t(r,{label:"显示菜单",prop:"meta.showLink"},{default:n(()=>[t(z,{modelValue:l(a).meta.showLink,"onUpdate:modelValue":e[4]||(e[4]=o=>l(a).meta.showLink=o)},null,8,["modelValue"])]),_:1}),t(r,{label:"菜单图标",prop:"meta.icon"},{default:n(()=>[t(O,{title:"图标",width:350,placement:"top",trigger:"click"},{reference:n(()=>[l(a).meta.icon?(p(),E(f,{key:0,size:20,class:"icon"},{default:n(()=>[(p(),E(x(l(a).meta.icon)))]),_:1})):(p(),V("span",ve,"选择图标"))]),default:n(()=>[(p(),V(H,null,J(C,(o,g)=>t(f,{key:g,class:"icon",size:15,onClick:ke=>l(a).meta.icon=g},{default:n(()=>[(p(),E(x(o)))]),_:2},1032,["onClick"])),64))]),_:1})]),_:1}),t(r,{label:"上级菜单"},{default:n(()=>[t(P,{modelValue:l(a).pid,"onUpdate:modelValue":e[5]||(e[5]=o=>l(a).pid=o),data:l(v),props:{label:o=>o.meta.title,value:"id"},"check-strictly":"","render-after-expand":!1,clearable:"",style:{width:"240px"}},null,8,["modelValue","data","props"])]),_:1}),t(r,null,{default:n(()=>[t(d,{class:"w-full",type:"primary",onClick:e[6]||(e[6]=o=>T(l(k)))},{default:n(()=>[w(" 保存 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),nt=_e(Ve,[["__scopeId","data-v-e306cf4b"]]);export{nt as default};
