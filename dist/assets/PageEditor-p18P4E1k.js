import{d as ne,aF as Le,ao as $e,x as ke,y as fe,aG as Se,c as z,e as H,l as G,w as C,B as e,g as L,aH as De,E as J,aI as Ae,G as te,f as ye,k as T,n as V,z as ce,r as x,o as Ie,aa as oe,ac as re,W,m as ue,t as Ye,ax as Pe,az as Ne,aJ as Me,aK as Ce,aL as Ee,ap as be,an as se,aM as Xe,L as Te,a1 as pe,R as Be}from"./index-DIMNw_Zj.js";import{E as Re}from"./index-CtTxH7lL.js";import{E as Ve,a as He,b as U,t as Q,f as le,g as Fe,m as We,d as qe,e as me,u as je,h as Ge,i as _e,N as xe,U as Je,j as Oe}from"./animation-Bp45U-t7.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as ze}from"./index-BLQajIEX.js";import{E as Ue}from"./el-checkbox-D1rcqvlA.js";import{E as Qe}from"./index-BORlPtjh.js";import{E as Ke}from"./index-XCTi-11Y.js";const Ze={key:2,class:"header"},et={class:"content"},tt=ne({__name:"Drawer",props:Le({width:{type:String,default:"30%"},direction:{type:String,default:"rtl"}},{modelValue:{type:Boolean,default:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(i){$e(a=>({"08bb6b10":d.value}));const m=i,h=ke(),d=fe(()=>h.header?"35px":"0px"),c=fe(()=>({width:m.direction=="rtl"||m.direction=="ltr"?m.width:"100%",height:m.direction=="ttb"||m.direction=="btt"?m.width:"100%"})),v=Se(i,"modelValue");return(a,g)=>(z(),H("div",{class:V(["drawer",[{hide:!v.value},m.direction]]),style:ce({width:c.value.width,height:c.value.height})},[i.direction=="rtl"||i.direction=="ltr"?(z(),G(L(J),{key:0,class:"switch",size:"12",onClick:g[0]||(g[0]=l=>v.value=!v.value)},{default:C(()=>[e(L(De))]),_:1})):i.direction=="ttb"||i.direction=="btt"?(z(),G(L(J),{key:1,class:"switch",size:"12",onClick:g[1]||(g[1]=l=>v.value=!v.value)},{default:C(()=>[e(L(Ae))]),_:1})):te("",!0),a.$slots.header?(z(),H("div",Ze,[ye(a.$slots,"header",{},void 0,!0)])):te("",!0),T("div",et,[e(L(Re),null,{default:C(()=>[ye(a.$slots,"default",{},void 0,!0)]),_:3})])],6))}}),he=we(tt,[["__scopeId","data-v-1b27b7be"]]),ot={__name:"PieMenu",props:{data:{type:Array,default(){return[{title:"菜单1",handleClick:()=>{},children:[{title:"菜单1-1",handleClick:()=>{}},{title:"菜单1-2",handleClick:()=>{}}]},{title:"菜单2",handleClick:()=>{},children:[{title:"菜单2-1",handleClick:()=>{}},{title:"菜单2-2",handleClick:()=>{}}]}]}}},emits:["click"],setup(i,{emit:m}){$e(p=>({"4a24d064":r.value,"5145de5e":L(l)}));const h=i,d=m,c=2*Math.PI;let v=x(),a=x(),g=x(80),l=fe(()=>`${g.value}px`),P=fe(()=>g.value/2),w=x(70),b=x(c);const u=new WeakMap,r=x("15px"),k=p=>{const $=!u.get(p),{level:M,index:D,pIndex:R}=p.dataset,E=R.split("-");u.set(p,$),v.value.querySelectorAll("div[data-level]").forEach(t=>{E.includes(t.dataset.index)||p===t||(t.dataset.level>Number(M)&&t.classList.remove("show"),t.classList.remove("active"),u.set(t,!1))}),$?(p.classList.add("active"),v.value.querySelectorAll(`div[data-level='${+M+1}'][data-p-index*='${D}']`).forEach(s=>s.classList.add("show"))):p.classList.remove("active")},S=()=>Math.random().toString(16).replace(".","");let N=(p,$,M)=>{const D=b.value/p.length,R=D>=c?c-.001:D,E=p.length==1?1:0;for(let n=0,t=p;n<t.length;n++){let s=P.value+w.value*$,_=n*R,y=(n+1)*R,q=s+Math.sin(_)*s,K=s-Math.cos(_)*s,Z=s+Math.sin(y)*s,o=s-Math.cos(y)*s,f=document.createElement("div");f.classList.add("menu-item"),f.dataset.level=+$,f.dataset.index=S(),f.dataset.pIndex=M.dataset.pIndex?`${M.dataset.pIndex}-${M.dataset.index}`:`${M.dataset.index}`,f.style.setProperty("width",`${s*2}px`),f.style.setProperty("height",`${s*2}px`),f.style.setProperty("z-index",-$),f.style.setProperty("clip-path",`path("M ${s} ${s} L ${q} ${K} A ${s} ${s} 0 ${E} 1 ${Z} ${o} z")`);const A=document.createElement("div");A.className="item-bg",$%2==0?A.classList.add("bg-even"):A.classList.add("bg-odd"),y=(n+1)*R-.01,q=s+Math.sin(_)*s,K=s-Math.cos(_)*s,Z=s+Math.sin(y)*s,o=s-Math.cos(y)*s,A.style.setProperty("width",`${s*2}px`),A.style.setProperty("height",`${s*2}px`),A.style.setProperty("clip-path",`path("M ${s} ${s} L ${q} ${K} A ${s} ${s} 0 ${E} 1 ${Z} ${o} z")`),f.appendChild(A);let F=(n+1/2)*R,de=s-w.value/2,j=document.createElement("div");j.style.left=s+Math.sin(F)*de+"px",j.style.top=s-Math.cos(F)*de+"px",j.style.setProperty("position","absolute"),j.style.textAlign="center",j.style.transform=`translate(-50%, -50%) rotate(${-Math.PI/2+F}rad)`;let O=document.createElement("div"),ae=F>Math.PI?Math.PI:0;O.style.display="inline-block",O.innerText=t[n].title,O.style.width=`${w.value-10}px`,O.style.transform=`rotateY(${ae}rad) rotateX(${ae}rad)`,j.appendChild(O),f.appendChild(j),f.addEventListener("pointerdown",()=>{var ie,ee;(ee=(ie=t[n]).handleClick)==null||ee.call(ie),d("click",t[n].title)}),f.addEventListener("pointerdown",()=>k(f)),v.value.insertAdjacentElement("afterbegin",f),t[n].children&&N(t[n].children,$+1,f)}};const X=(p,$)=>{let M={offsetX:0,offsetY:0};const D=R=>{const E=R.clientX,n=R.clientY,{offsetX:t,offsetY:s}=M,_=p.getBoundingClientRect(),y=_.left,q=_.top,K=_.width,Z=_.height,o=document.documentElement.clientWidth,f=document.documentElement.clientHeight,A=-y+t,F=-q+s,de=o-y-K+t,j=f-q-Z+s,O=ie=>{let ee=t+ie.clientX-E,ve=s+ie.clientY-n;ee=Math.min(Math.max(ee,A),de),ve=Math.min(Math.max(ve,F),j),M={offsetX:ee,offsetY:ve},p&&(p.style.transform=`translate(${ee}px, ${ve}px)`)},ae=()=>{document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",ae)};document.addEventListener("mousemove",O),document.addEventListener("mouseup",ae)};$.addEventListener("mousedown",D)},I=()=>{X(v.value,a.value);const p="0",$=S();a.value.dataset.level=p,a.value.dataset.index=$,a.value.dataset.pIndex="",N(h.data,+p+1,a.value),a.value.addEventListener("pointerdown",M=>k(a.value))};return Ie(()=>{I()}),(p,$)=>(z(),H("div",{ref_key:"rongQi",ref:v,class:"rong-qi"},[T("div",{ref_key:"center",ref:a,class:"center",draggable:"false",onDblclick:$[0]||($[0]=M=>d("click","center"))},[ye(p.$slots,"center",{draggable:"false"},()=>[oe("菜单")],!0)],544)],512))}},nt=we(ot,[["__scopeId","data-v-9e36371f"]]),st="_editor_o961q_1",lt="_container_o961q_93",at="_views_o961q_115",B={editor:st,container:lt,views:at,"views-title":"_views-title_o961q_123","views-container":"_views-container_o961q_131","views-tabs":"_views-tabs_o961q_147"},it=ne({__name:"ComponentViews",props:["viewNodes"],setup(i){return(m,h)=>{const d=ze,c=Ve,v=He;return z(),G(v,{"model-value":["1","2","3","4","5"],class:V(L(B).views)},{default:C(()=>[e(c,{name:"1"},{title:C(()=>[e(d,{class:V(L(B)["views-title"]),tag:"b"},{default:C(()=>[oe(" 布局 ")]),_:1},8,["class"])]),default:C(()=>[T("div",{class:V(L(B)["views-container"])},[(z(!0),H(W,null,re(i.viewNodes,a=>(z(),H(W,{key:a.uuid},[a.isLayoutNode?(z(),G(ue(a.view),{key:0})):te("",!0)],64))),128))],2)]),_:1}),e(c,{name:"2"},{title:C(()=>[e(d,{class:V(L(B)["views-title"]),tag:"b"},{default:C(()=>[oe(" 表单 ")]),_:1},8,["class"])]),default:C(()=>[T("div",{class:V(L(B)["views-container"])},[(z(!0),H(W,null,re(i.viewNodes,a=>(z(),H(W,{key:a.uuid},[a.isFormNode?(z(),G(ue(a.view),{key:0})):te("",!0)],64))),128))],2)]),_:1}),e(c,{name:"3"},{title:C(()=>[e(d,{class:V(L(B)["views-title"]),tag:"b"},{default:C(()=>[oe(" 图表 ")]),_:1},8,["class"])]),default:C(()=>[T("div",{class:V(L(B)["views-container"])},[(z(!0),H(W,null,re(i.viewNodes,a=>(z(),H(W,{key:a.uuid},[a.isChartNode?(z(),G(ue(a.view),{key:0})):te("",!0)],64))),128))],2)]),_:1}),e(c,{name:"4"},{title:C(()=>[e(d,{class:V(L(B)["views-title"]),tag:"b"},{default:C(()=>[oe(" 数据展示 ")]),_:1},8,["class"])]),default:C(()=>[T("div",{class:V(L(B)["views-container"])},[(z(!0),H(W,null,re(i.viewNodes,a=>(z(),H(W,{key:a.uuid},[a.isDataNode?(z(),G(ue(a.view),{key:0})):te("",!0)],64))),128))],2)]),_:1}),e(c,{name:"5"},{title:C(()=>[e(d,{class:V(L(B)["views-title"]),tag:"b"},{default:C(()=>[oe(" 导航 ")]),_:1},8,["class"])]),default:C(()=>[T("div",{class:V(L(B)["views-container"])},[(z(!0),H(W,null,re(i.viewNodes,a=>(z(),H(W,{key:a.uuid},[a.isNavigationNode?(z(),G(ue(a.view),{key:0})):te("",!0)],64))),128))],2)]),_:1})]),_:1},8,["class"])}}}),rt=["onMouseover","onClick"],ut=["onPointerdown"],ct=["onPointerdown"],dt=["onPointerdown"],vt=["onPointerdown"],ft=["onPointerdown"],pt=ne({__name:"ViewsTree",props:["page","hoveredNode","selectedNode","controls"],emits:["hoverNode","selectNode"],setup(i,{emit:m}){const h=i,d=m,c=(b,u,r)=>r=="inner"?u.data.isContainerNode:!u.data.isNPage,v=(b,u,r)=>{r=="inner"?b.data.parent=u.data:b.data.parent=u.data.parent},a=(b,u)=>{var r;return(r=h.controls)==null?void 0:r.moveBefore(b,u)},g=(b,u)=>{var r;return(r=h.controls)==null?void 0:r.moveAfter(b,u)},l=(b,u)=>{var r;return(r=h.controls)==null?void 0:r.copyNode(b,u)},P=(b,u)=>{var r;return(r=h.controls)==null?void 0:r.pasteNode(b,u)},w=(b,u)=>{var r;return(r=h.controls)==null?void 0:r.removeNode(b,u)};return(b,u)=>{const r=J,k=Ue;return z(),G(k,{style:{width:"500px"},data:[i.page],props:{label:"name"},"node-key":"uuid","expand-on-click-node":!1,"default-expand-all":"",draggable:"","allow-drop":c,onNodeDrop:v},{default:C(({node:S,data:N})=>{var X,I;return[T("div",{class:V(["n-tree-node",{hovered:((X=i.hoveredNode)==null?void 0:X.uuid)==N.uuid,selected:((I=i.selectedNode)==null?void 0:I.uuid)==N.uuid}]),style:{flex:"1"},onMouseover:p=>d("hoverNode",{targetNode:be(N)}),onClick:p=>d("selectNode",{targetNode:be(N)})},[T("span",null,Ye(S.label),1),T("div",null,[T("div",{class:"button",style:ce({display:N.isNPage?"none":"initial"}),onPointerdown:p=>a(p,N)},[e(r,{size:13,color:"#08f"},{default:C(()=>[e(L(Pe))]),_:1})],44,ut),T("div",{class:"button",style:ce({display:N.isNPage?"none":"initial"}),onPointerdown:p=>g(p,N)},[e(r,{size:13,color:"#08f"},{default:C(()=>[e(L(Ne))]),_:1})],44,ct),T("div",{class:"button",style:ce({display:N.isNPage?"none":"initial"}),onPointerdown:p=>l(p,N)},[e(r,{size:13,color:"#a50"},{default:C(()=>[e(L(Me))]),_:1})],44,dt),T("div",{class:"button",onPointerdown:p=>P(p,N)},[e(r,{size:13,color:"#a50"},{default:C(()=>[e(L(Ce))]),_:1})],40,vt),T("div",{class:"button",style:ce({display:N.isNPage?"none":"initial"}),onPointerdown:p=>w(p,N)},[e(r,{size:13,color:"#a00"},{default:C(()=>[e(L(Ee))]),_:1})],44,ft)])],42,rt)]}),_:1},8,["data"])}}}),mt=we(pt,[["__scopeId","data-v-3a80b77c"]]),ht="_controls_7de2p_1",gt="_button_7de2p_95",yt="_guide_7de2p_131",Y={controls:ht,"right-resize":"_right-resize_7de2p_41","bottom-resize":"_bottom-resize_7de2p_59","corner-resize":"_corner-resize_7de2p_77","button-list":"_button-list_7de2p_95",button:gt,guide:yt,"guide-horizontal":"_guide-horizontal_7de2p_145","guide-vertical":"_guide-vertical_7de2p_159"};function wt(i,m,h=!0,d){let c={offsetX:0,offsetY:0};const v=a=>{const g=window.getComputedStyle(i),l=Number.parseFloat(g.getPropertyValue("left")),P=Number.parseFloat(g.getPropertyValue("top"));if(g.position!="absolute")return;c={offsetX:l,offsetY:P};const w=a.clientX,b=a.clientY,{offsetX:u,offsetY:r}=c,k=i.getBoundingClientRect(),S=k.left,N=k.top,X=k.width,I=k.height,p=document.documentElement.clientWidth,$=document.documentElement.clientHeight,M=-S+u,D=-N+r,R=p-S-X+u,E=$-N-I+r,n=s=>{let _=u+s.clientX-w,y=r+s.clientY-b;h||(_=Math.min(Math.max(_,M),R),y=Math.min(Math.max(y,D),E)),c={offsetX:_,offsetY:y},i&&(i.style.left=`${_}px`,i.style.top=`${y}px`),d==null||d(s)},t=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",t)};document.addEventListener("mousemove",n),document.addEventListener("mouseup",t)};return m.addEventListener("mousedown",v),()=>{m.removeEventListener("mousedown",v)}}function bt(i,m){const h=d=>{if(window.getComputedStyle(i).position=="absolute")return;i.setAttribute("draggable","true");const c=v=>{i.setAttribute("draggable","false"),document.removeEventListener("mouseup",c)};document.addEventListener("mouseup",c)};return m.addEventListener("mousedown",h),()=>{m.removeEventListener("mousedown",h)}}function ge(i,m,h,d){const c=v=>{const a=window.getComputedStyle(i),g=Number.parseFloat(a.getPropertyValue("width")),l=Number.parseFloat(a.getPropertyValue("height")),P=v.clientX,w=v.clientY,b=r=>{let k=r.clientX-P+g,S=r.clientY-w+l;i&&(h===0?i.style.width=`${k}px`:h===1?i.style.height=`${S}px`:(i.style.width=`${k}px`,i.style.height=`${S}px`)),d==null||d(r)},u=()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",u)};document.addEventListener("mousemove",b),document.addEventListener("mouseup",u)};return m.addEventListener("mousedown",c),()=>{m.removeEventListener("mousedown",c)}}function _t(i,m){const h=d=>{d.preventDefault(),d.stopPropagation();const{deltaY:c}=d,v=5e-4,l=window.getComputedStyle(i).getPropertyValue("transform").match(/matrix\(([-\d\.]+), ([-\d\.]+), ([-\d\.]+), ([-\d\.]+), ([-\d\.]+), ([-\d\.]+)\)/);let P=+(l==null?void 0:l[1])||1;const w=+(l==null?void 0:l[2])||0,b=+(l==null?void 0:l[3])||0;let u=+(l==null?void 0:l[4])||1;const r=+(l==null?void 0:l[5])||0,k=+(l==null?void 0:l[6])||0;P+=-c*v,u+=-c*v,i.style.transform=`matrix(${P}, ${w}, ${b}, ${u}, ${r}, ${k})`,m==null||m(d)};return i.addEventListener("wheel",h),()=>{i.removeEventListener("wheel",h)}}const xt=ne((i,{expose:m})=>{const h=x(),d=x(),c=x(),v=x(),a=5,g=()=>{h.value.style.visibility=d.value.style.visibility=c.value.style.visibility=v.value.style.visibility="hidden",h.value.style.left=d.value.style.left=c.value.style.top=v.value.style.top="0"};return m({hideGuides:g,showGuides:P=>{if(!(P&&h.value&&d.value&&c.value&&v.value))return;g();const w=P.elRef.value,b=i.page.getAllNodes().filter(I=>!I.isNPage&&I!==P).map(I=>I.elRef.value),{left:u,right:r,top:k,bottom:S,width:N,height:X}=w.getBoundingClientRect();for(let I=0,p=b.length;I<p;I++){const $=b[I];if(!$)continue;const{left:M,right:D,top:R,bottom:E}=$.getBoundingClientRect();let n,t=i.page.elRef.value;(n=Math.abs(M-u)<=a&&M||Math.abs(D-u)<=a&&D)&&(h.value.style.visibility="visible",U(h.value,n,"left",t),U(P.elRef.value,n,"left",t)),(n=Math.abs(M-r)<=a&&M||Math.abs(D-r)<=a&&D)&&(d.value.style.visibility="visible",U(d.value,n,"left",t),U(P.elRef.value,n-N,"left",t)),(n=Math.abs(R-k)<=a&&R||Math.abs(E-k)<=a&&E)&&(c.value.style.visibility="visible",U(c.value,n,"top",t),U(P.elRef.value,n,"top",t)),(n=Math.abs(R-S)<=a&&R||Math.abs(E-S)<=a&&E)&&(v.value.style.visibility="visible",U(v.value,n,"top",t),U(P.elRef.value,n-X,"top",t))}P.updateStyle()}}),()=>e(W,null,[e("div",{ref:h,class:`${Y.guide} ${Y["guide-vertical"]}`},null),e("div",{ref:d,class:`${Y.guide} ${Y["guide-vertical"]}`},null),e("div",{ref:c,class:`${Y.guide} ${Y["guide-horizontal"]}`},null),e("div",{ref:v,class:`${Y.guide} ${Y["guide-horizontal"]}`},null)])},{props:{page:{type:Object}}}),$t=ne((i,{attrs:m,emit:h,expose:d})=>{const c=x(),v=x(),a=x(),g=x(),l=x(),P=x(),w=se(),b=x({...m.style}),u=[],r=()=>{w.value=null,c.value.remove(),u.forEach(n=>n())},k=n=>{n&&n.append(c.value)},S=()=>{w.value&&w.value.updateStyle()},N=n=>{var t;(t=P.value)==null||t.showGuides(w.value),S()},X=n=>{r(),P.value.hideGuides(),w.value=n,k(n.elRef.value);const t=ge(n.elRef.value,a.value,0,S),s=ge(n.elRef.value,g.value,1,S),_=ge(n.elRef.value,l.value,2,S),y=wt(n.elRef.value,v.value,!0,N);u.push(y,t,s,_),n.isNPage?u.push(_t(n.elRef.value,S)):u.push(bt(n.elRef.value,v.value))},I=(n,t)=>{if(n.preventDefault(),n.stopPropagation(),!t)return;const s=t.parent,_=s.children.indexOf(t),y=s.children[_-1];y&&s.insert(t,y)},p=(n,t)=>{if(n.preventDefault(),n.stopPropagation(),!t)return;const s=t.parent,_=s.children.indexOf(t),y=s.children[_+1];y&&s.insert(t,y,"after")},$=x(""),M=(n,t)=>{if(n.preventDefault(),n.stopPropagation(),!t)return;const s=Q(t),_=le(s);$.value=s,_.traverse(q=>q.uuid=Fe()),t.parent.insert(_,t,"after")},D=(n,t)=>{if(n.preventDefault(),n.stopPropagation(),!t||!$.value)return;const s=le($.value);t!=null&&t.isContainerNode?t.add(s):t.parent.add(s)},R=(n,t)=>{if(n.preventDefault(),n.stopPropagation(),!t)return;r(),t.parent.remove(t),h("removeNode")};d({control:X,clearControl:r,moveBefore:I,moveAfter:p,copyNode:M,pasteNode:D,removeNode:R});const E=x("#fff");return()=>{var n,t,s,_;return e("div",{ref:c,class:Y.controls,style:b.value},[e("div",{ref:a,class:Y["right-resize"]},null),e("div",{ref:g,class:Y["bottom-resize"]},null),e("div",{ref:l,class:Y["corner-resize"]},null),e("div",{class:Y["button-list"]},[e("div",{ref:v,class:Y.button},[e(ze,{style:`--el-text-color: ${E.value};`},{default:()=>{var y;return[(y=w.value)==null?void 0:y.name]}})]),e("div",{ref:v,class:Y.button},[e(J,{size:15,color:`${E.value}`},{default:()=>[e(Xe,null,null)]})]),e("div",{class:Y.button,style:{display:(n=w.value)!=null&&n.isNPage?"none":"initial"},onPointerdown:y=>I(y,w.value)},[e(J,{size:15,color:`${E.value}`},{default:()=>[e(Pe,null,null)]})]),e("div",{class:Y.button,style:{display:(t=w.value)!=null&&t.isNPage?"none":"initial"},onPointerdown:y=>p(y,w.value)},[e(J,{size:15,color:`${E.value}`},{default:()=>[e(Ne,null,null)]})]),e("div",{class:Y.button,style:{display:(s=w.value)!=null&&s.isNPage?"none":"initial"},onPointerdown:y=>M(y,w.value)},[e(J,{size:15,color:`${E.value}`},{default:()=>[e(Me,null,null)]})]),e("div",{class:Y.button,onPointerdown:y=>D(y,w.value)},[e(J,{size:15,color:`${E.value}`},{default:()=>[e(Ce,null,null)]})]),e("div",{class:Y.button,style:{display:(_=w.value)!=null&&_.isNPage?"none":"initial"},onPointerdown:y=>R(y,w.value)},[e(J,{size:15,color:`${E.value}`},{default:()=>[e(Ee,null,null)]})])]),e(xt,{page:i.page,ref:P},null)])}},{props:{page:{type:Object}},emits:["removeNode"]}),Pt=ne((i,{expose:m})=>{const h=x(),d=x(),c=x({pointerEvents:"none",position:"absolute",zIndex:"100",inset:"0",boxSizing:"border-box",border:"2px dashed var(--color-8)"}),v=()=>{d.value=null,h.value.remove()},a=l=>{l&&l.append(h.value)};return m({hover:l=>{v(),d.value=l,a(l.elRef.value)},clearHover:v}),()=>e("div",{ref:h,style:c.value},null)});function Nt(i,m){var h;m.isContainerNode?m.add(i):(h=m.parent)==null||h.insert(i,m,"after")}const Dt=ne((i,{emit:m,expose:h})=>{const d=x(),c=se([]);c.value=Object.values(We).filter(o=>o.preview).map(o=>new o);const v=x([{title:"退出",handleClick:()=>{m("exit")}},{title:"全屏",handleClick:()=>{const o=d.value;o&&(document.fullscreenElement==o?document.exitFullscreen():o.requestFullscreen())}},{title:"编辑",children:[{title:"撤销",handleClick:()=>{I()}},{title:"恢复",handleClick:()=>{p()}}]},{title:"文件",children:[{title:"导出",children:[{title:"导出当前编辑页面vue",handleClick:()=>{l.value&&(l.value.resetStyle(),qe(l.value).then(o=>{me(o,"Page.zip")}))}},{title:"导出当前编辑页面json",handleClick:()=>{if(!l.value)return;l.value.resetStyle();const o=Q(l.value);me(o,"page.json")}},{title:"导出所有页面json",handleClick:()=>{g.value.forEach(f=>f.resetStyle());const o=Q(g.value);me(o,"allPages.json")}}]},{title:"导入json",handleClick:()=>{je(o=>{o.text().then(f=>{const A=le(f);Array.isArray(A)?A.forEach(F=>r(F)):r(A)})})}}]}]),a=x(),g=x([]),l=x();let P=null;const w=se(),b=new WeakMap,u=o=>{if(l.value=o,w.value=null,!o)return;P=o.component;const f=g.value.findIndex(A=>A.uuid==o.uuid);f!==-1&&g.value.splice(f,1,l.value)},r=o=>{b[o.uuid]=new Je,g.value.push(o),u(o)},k=o=>{const f=g.value.findIndex(A=>A.uuid==o.uuid);if(f!==-1&&g.value.splice(f,1),o.uuid==l.value.uuid){const A=g.value[f-1],F=g.value[f];u(F||A)}},S=o=>{if(g.value=[],!o)return r(new xe);const f=le(o);Array.isArray(f)?f.forEach(A=>r(A)):r(f)},N=o=>o?Q(g.value):Q(l.value);Te([l,g],()=>{if(m("change",Q(l.value),Q(g.value)),!X&&l.value){const o=b[l.value.uuid];o==null||o.push(Q(l.value))}else X=!1},{deep:!0,flush:"post"});let X=!1;const I=()=>{if(!l.value)return;const o=b[l.value.uuid];o==null||o.undo(f=>{u(le(f)),X=!0})},p=()=>{if(!l.value)return;const o=b[l.value.uuid];o==null||o.redo(f=>{u(le(f)),X=!0})},$=o=>{w.value=o,o.active=!0,Be(()=>{a.value.control(o)})},M=o=>{l.value.traverse(f=>f.active=!1),$(o.targetNode)},D=se(),R=x(),E=o=>{D.value=o.targetNode,R.value.hover(o.targetNode)},n=o=>{D.value=null,R.value.clearHover()},t=se(),s=se(),_=o=>{t.value=o.targetNode},y=200,q=Oe(o=>{t.value&&(s.value=o.targetNode,Nt(t.value,s.value),$(t.value))},y),K=o=>{setTimeout(()=>t.value=s.value=null,y)},Z=()=>{w.value=null};return h({setData:S,getData:N}),()=>pe("div",{ref:d,class:B.editor,onDragend:K,onDragNode:_},[e(nt,{data:v.value},null),e(he,{width:"330px",direction:"ltr"},{default:()=>e(Ge,{class:B["views-tabs"],type:"border-card"},{default:()=>[e(_e,{label:"组件"},{default:()=>[e(it,{viewNodes:c.value},null)]}),e(_e,{label:"视图结构"},{default:()=>[e(Re,null,{default:()=>[l.value?e(mt,{page:l.value,hoveredNode:D.value,selectedNode:w.value,controls:a.value,onHoverNode:E,onSelectNode:M},null):null]})]})]})}),l.value?pe("div",{class:B.container,onMouseleave:n,onHoverNode:E,onSelectNode:M,onDragenterNode:q},e(P,null,null)):"",e(he,{width:"330px"},{header:()=>e("span",null,[oe("参数")]),default:()=>w.value?pe(w.value.params):""}),e(he,{modelValue:!1,width:"30px",direction:"ttb"},{default:()=>[...g.value.map(o=>{var f;return e(Qe,{color:o.uuid==((f=l.value)==null?void 0:f.uuid)?"var(--color-5)":"var(--color-1)",effect:"dark",style:"cursor: pointer",size:"small",closable:!0,onClick:()=>u(o),onClose:()=>k(o)},{default:()=>[o.props.name]})}),e(Ke,{size:"small",circle:!0,icon:"Plus",onClick:()=>r(new xe)},null)]}),e($t,{ref:a,page:l.value,style:{display:w.value?"block":"none"},onRemoveNode:Z},null),e(Pt,{ref:R,style:{display:D.value?"block":"none"}},null)])},{emits:["change","exit"]});export{Dt as S};
