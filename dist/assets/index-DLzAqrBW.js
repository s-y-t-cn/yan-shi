import{r as F,y as Q,o as Y,aa as Z,c as N,e as ee,A as te,d as ae,k as ne,w as f,M as o,g as se}from"./index-wChoSQeH.js";import{E as oe}from"./el-space-DCaxWfY8.js";import{E as re}from"./el-card-DX43uJLz.js";import{_ as le}from"./Line.vue_vue_type_script_setup_true_lang-Ce3vCJPj.js";import{_ as ie}from"./Bar.vue_vue_type_script_setup_true_lang-DCVSb9tG.js";import{_ as ce}from"./Pie.vue_vue_type_script_setup_true_lang-DSBAZa3d.js";import{S as de,P as pe,W as me,O as he,A as ue,a as fe,G as $,b as z,E as I,M as we,c as T,d as be,T as xe,e as ge,f as _e,B as Se,V as G,L as ye,g as ve,h as Me}from"./three-C9DdkaV9.js";import"./vnode-DAic0pXr.js";import"./plugin-vue_export-helper-CqGSI99y.js";import"./index-Cc46_B1g.js";const M=10,Ee={__name:"SytPieChart",props:{width:[String,Number],height:[String,Number],params:{type:Object,default(){return{radius:5,data:[{label:"",value:0,color:"#fff"}]}}}},setup(w){const b=F(),a=w,i=new de,n=new pe(75,a.width/a.height,.1,1e3),c=new me({antialias:!0,alpha:!0}),E=new he(n,c.domElement);E.autoRotate=!0;const V=new ue(5263440);i.add(V);const y=new fe(16777215,10,32,3);y.position.set(0,15,5),y.castShadow=!0,i.add(y),c.setSize(a.width,a.height),n.position.set(5,15,12);let s=new $,A=a.params.data.reduce((e,r)=>e+=r.value,0),m=0,j=10;const D=e=>{let r=e.value/A,h=Math.PI*2*r+m,d=j*r;d<1&&(d=1);const l=new z;l.absarc(0,0,M,m,h),l.absarc(0,0,a.params.radius,h,m,!0);const u={steps:2,depth:d,bevelEnabled:!1};let p=e.color??`#${Math.random().toString().slice(2,8)}`;const R=new I(l,u),X=new be({color:p,transparent:!0,opacity:.8,emissive:p,emissiveIntensity:.3}),v=new T(R,X);v.castShadow=!0,s.add(v),m=h;let x=document.createElement("canvas");x.setAttribute("width","100"),x.setAttribute("height","100");let t=x.getContext("2d");t.font="15px math",t.textAlign="center",t.strokeStyle="#fff",t.fillStyle="rgba(65, 165, 251, 1)",t.textBaseline="bottom",t.fillText(e.label,50,89),t.font="13px math",t.strokeStyle="#f00",t.fillStyle=p,t.textBaseline="bottom",t.fillText(e.value,50,100),t.measureText(e.label);const U=new xe().load(x.toDataURL()),B=new ge({map:U});B.sizeAttenuation=!1;const g=new _e(B);g.scale.set(.6,.6,.6),g.center.set(.5,0);let k=new Se().setFromObject(v).getCenter(new G),_=k.clone();_.z=d+3;const W=new ye({color:p,linewidth:2});let q=5,H=_.clone().projectOnPlane(new G(0,0,1)).normalize(),O=_.clone().addScaledVector(H,q);const S=[];S.push(k),S.push(_),S.push(O);const J=new ve().setFromPoints(S),K=new Me(J,W);s.add(K),g.position.copy(O),s.add(g)},L=()=>{i.remove(s),s=new $,A=a.params.data.reduce((u,p)=>u+=p.value,0),m=0;const e=new z;e.absarc(0,0,M+1,0,Math.PI),e.absarc(0,0,M+1,Math.PI,0);const r={steps:2,depth:.5,bevelEnabled:!1},h=new I(e,r),d=new we({color:"#155a81"}),l=new T(h,d);l.castShadow=!0,l.position.z=-1,s.add(l),s.rotateX(-Math.PI/2),i.add(s),a.params.data.forEach(u=>D(u))};let P=null;const C=()=>{P=requestAnimationFrame(C),E.update(),c.render(i,n)};return Q(()=>a.params.data,()=>{L()},{deep:!0}),Y(()=>{b.value.appendChild(c.domElement),L(),C()}),Z(()=>{cancelAnimationFrame(P)}),(e,r)=>(N(),ee("div",{ref_key:"container",ref:b,style:te({width:`${w.width}px`,height:`${w.height}px`})},null,4))}},Ge=ae({__name:"index",setup(w){let b=F({radius:5,data:[{label:"好家庭",value:10,color:"#40abc7"},{label:"好张三",value:2,color:"#f29754"},{label:"好职工",value:4,color:"#f5bb4f"},{label:"好商户",value:6,color:"#8ecff0"},{label:"好李四",value:8}]});return(a,i)=>{const n=re,c=oe;return N(),ne(c,{wrap:""},{default:f(()=>[o(n,{style:{width:"500px"}},{default:f(()=>[o(le)]),_:1}),o(n,{style:{width:"500px"}},{default:f(()=>[o(ie)]),_:1}),o(n,{style:{width:"500px"}},{default:f(()=>[o(ce)]),_:1}),o(n,{style:{width:"540px"}},{default:f(()=>[o(Ee,{width:"500",height:"400",params:se(b)},null,8,["params"])]),_:1})]),_:1})}}});export{Ge as default};
