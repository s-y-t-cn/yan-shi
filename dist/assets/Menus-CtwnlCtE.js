import{d as J,r as i,o as K,P as h,c as p,e as V,k as Y,D as t,w as n,ac as w,g as l,l as E,m as x,Y as G,ae as H,ai as Q,bJ as W,bK as C,bL as X,bM as Z,bN as ee,al as b,E as te,bO as oe,bP as le}from"./index-Bsn8uhFR.js";/* empty css                   *//* empty css                     *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  */import{E as ae}from"./el-tree-select-Dhi-v-mF.js";/* empty css                    */import{E as ne}from"./el-popover-Ceu9nK0v.js";/* empty css                  *//* empty css                  */import{u as se}from"./menus-BQUNy1JH.js";import{S as re}from"./SytTable-CpLTqMDC.js";import{E as ie}from"./index-NV_0FHae.js";import{E as me}from"./index-f9LhncNo.js";import{E as pe,a as de}from"./index-WB42fc2K.js";import{E as ue}from"./index-C73im1hn.js";import{E as ce}from"./index-Cs2G8_c2.js";import{b as fe}from"./index-CEJYwNXW.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-qZKloEJB.js";import"./error-DyDUhvQa.js";import"./isEqual-DLLu8dhP.js";import"./index-li2vGeyt.js";import"./index-C-Yt4Yjn.js";import"./castArray-dThNn2ng.js";import"./index-9zNjbeCL.js";import"./index-DgBkyx5Q.js";import"./index-C2ioxsOw.js";import"./_baseClone-BqSBTuLD.js";import"./dropdown-Biev14ov.js";import"./vnode-Ce9ES3ru.js";const ge={class:"container"},be={class:"tools"},ve={key:1,class:"icon-select-text"},Ve=J({__name:"Menus",setup(Ee){const D=i([{title:"路由名",dataIndex:"name"},{title:"路由路径",dataIndex:"path"},{title:"组件路径",dataIndex:"component"},{title:"菜单名",dataIndex:"meta.title"},{title:"显示菜单",dataIndex:"meta.showLink"}]),I=se();let v=i([]),M=i(!0),m=i(!1),k=i(null),u=i("");const L=i({name:[{required:!0,message:"请输入路由名",trigger:"blur"}],path:[{required:!0,message:"请输入路由路径",trigger:"blur"}],component:[{required:!0,message:"请输入组件路径",trigger:"blur"}],"meta.title":[{required:!0,message:"请输入菜单名",trigger:"blur"}],"meta.showLink":[{required:!0,message:"显示菜单",trigger:"change"}]});let y=()=>({pid:"",path:"",name:"",component:"",meta:{icon:"",title:"",showLink:!0}}),a=i(y());const c=async()=>{await W().then(s=>{s.code===200&&(s.data.forEach(e=>{var d;e.iconComponent=C[(d=e.meta)==null?void 0:d.icon]}),v.value=X(s.data),I.SAVE_MENUS(s.data))}),M.value=!1},S=()=>{u.value="添加",m.value=!0,a.value=y()},U=s=>{u.value="编辑",m.value=!0,a.value=Z(s)},B=async()=>{let s=Object.assign({},a.value);oe(s).then(e=>{e.code==200&&(b({type:"success",message:"添加成功"}),c())})},F=async()=>{let s=Object.assign({},a.value);le(s).then(e=>{e.code==200&&(b({type:"success",message:"编辑成功"}),c())})},R=s=>{s._id?ee({_id:s._id}).then(e=>{e.code==200&&(b({type:"success",message:"删除成功"}),c())}):b({type:"error",message:"不存在的_id"})},T=s=>{s&&s.validate(e=>{e?(u.value==="添加"?B():F(),m.value=!1):console.log("验证失败!")})};return K(()=>{c()}),(s,e)=>{const d=ie,q=h("Edit"),f=te,N=h("Delete"),O=ne,_=me,r=pe,P=ue,z=ce,$=ae,j=de,A=fe;return p(),V("div",ge,[Y("div",be,[t(d,{onClick:S},{default:n(()=>[w("添加菜单")]),_:1})]),t(re,{columns:D.value,data:l(v)},{operations:n(({row:o})=>[t(f,{class:"icon",color:"#0af",onClick:g=>U(o)},{default:n(()=>[t(q)]),_:2},1032,["onClick"]),t(O,{title:"确定删除?",onConfirm:g=>R(o)},{reference:n(()=>[t(f,{class:"icon",color:"#f00"},{default:n(()=>[t(N)]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["columns","data"]),t(A,{modelValue:l(m),"onUpdate:modelValue":e[7]||(e[7]=o=>Q(m)?m.value=o:m=o),title:l(u),width:"350px"},{default:n(()=>[t(j,{ref_key:"ruleFormRef",ref:k,model:l(a),rules:L.value,size:"large",class:"w-full","label-width":"auto"},{default:n(()=>[t(r,{label:"路由名",prop:"name"},{default:n(()=>[t(_,{modelValue:l(a).name,"onUpdate:modelValue":e[0]||(e[0]=o=>l(a).name=o),placeholder:"路由名"},null,8,["modelValue"])]),_:1}),t(r,{label:"路由路径",prop:"path"},{default:n(()=>[t(_,{modelValue:l(a).path,"onUpdate:modelValue":e[1]||(e[1]=o=>l(a).path=o),placeholder:"需包含上级菜单的路径"},null,8,["modelValue"])]),_:1}),t(r,{label:"组件路径",prop:"component"},{default:n(()=>[t(_,{modelValue:l(a).component,"onUpdate:modelValue":e[2]||(e[2]=o=>l(a).component=o),placeholder:"/src/views/**.vue"},null,8,["modelValue"])]),_:1}),t(r,{label:"菜单名",prop:"meta.title"},{default:n(()=>[t(_,{modelValue:l(a).meta.title,"onUpdate:modelValue":e[3]||(e[3]=o=>l(a).meta.title=o),placeholder:"菜单名"},null,8,["modelValue"])]),_:1}),t(r,{label:"显示菜单",prop:"meta.showLink"},{default:n(()=>[t(P,{modelValue:l(a).meta.showLink,"onUpdate:modelValue":e[4]||(e[4]=o=>l(a).meta.showLink=o)},null,8,["modelValue"])]),_:1}),t(r,{label:"菜单图标",prop:"meta.icon"},{default:n(()=>[t(z,{title:"图标",width:350,placement:"top",trigger:"click"},{reference:n(()=>[l(a).meta.icon?(p(),E(f,{key:0,size:20,class:"icon"},{default:n(()=>[(p(),E(x(l(a).meta.icon)))]),_:1})):(p(),V("span",ve,"选择图标"))]),default:n(()=>[(p(),V(G,null,H(C,(o,g)=>t(f,{key:g,class:"icon",size:15,onClick:ke=>l(a).meta.icon=g},{default:n(()=>[(p(),E(x(o)))]),_:2},1032,["onClick"])),64))]),_:1})]),_:1}),t(r,{label:"上级菜单"},{default:n(()=>[t($,{modelValue:l(a).pid,"onUpdate:modelValue":e[5]||(e[5]=o=>l(a).pid=o),data:l(v),props:{label:o=>o.meta.title,value:"id"},"check-strictly":"","render-after-expand":!1,clearable:"",style:{width:"240px"}},null,8,["modelValue","data","props"])]),_:1}),t(r,null,{default:n(()=>[t(d,{class:"w-full",type:"primary",onClick:e[6]||(e[6]=o=>T(l(k)))},{default:n(()=>[w(" 保存 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),tt=_e(Ve,[["__scopeId","data-v-e306cf4b"]]);export{tt as default};
