import{d as N,af as V,r as u,L as F,y as T,c as f,l as x,w as o,B as m,k as p,t as _,g as w,e as D,ac as O,W as E,aa as I,G as L,ak as z,al as J}from"./index-s4B7ioPK.js";import{E as W}from"./el-space-fY8n7zpQ.js";/* empty css                  */import{E as $,a as j}from"./el-timeline-item-kYEW9jG_.js";/* empty css                */import{w as G,f as U}from"./examples-DNoEl8LE.js";import{E as q}from"./index-eEeYcRJ7.js";import{E as A}from"./index-B0ZkurPq.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vnode-HXEciRAe.js";const K=n=>(z("data-v-b86a9b45"),n=n(),J(),n),M=K(()=>p("span",null,"流程",-1)),P=N({__name:"View",props:{data:Object},emits:["examine"],setup(n,{emit:S}){const h=V(),v=n,y=S;let r=u({name:"",status:"",submitter:{},formData:[],flowData:[]}),d=u(!1);F(()=>JSON.parse(JSON.stringify(v.data)),async a=>{let e=a.formData,t=(await U({name:a.name})).data.formData;for(let s in e)g(s,t).value=e[s];r.value=a,r.value.formData=t,d.value=!1},{deep:!0,immediate:!0});const g=(a,e)=>{for(let t of e)if(t.type==="layout"){for(let s of t.cols)for(let c of s.children)if(a===c.field)return c}else if(a===t.field)return t};let i=u({flowId:"",examineId:"",status:""}),B=T(()=>{let a=r.value.flowData.map(e=>{switch(i.value.flowId=r.value._id,e.status){case"未处理":e.color="";break;case"处理中":e.color="",e.username===h.username&&(d.value=!0,i.value.examineId=e.id);break;case"通过":e.color="#00aabb";break;case"否决":e.color="#ff0000"}return e});return a.unshift({type:"发起人",label:r.value.submitter.nickname,color:"#00aabb"}),a});u();const b=a=>{i.value.status=a,G(i.value).then(()=>y("examine"))};return(a,e)=>{const t=q,s=j,c=$,k=A,C=W;return f(),x(C,{direction:"vertical",fill:"",class:"submit-container"},{default:o(()=>[m(t,null,{header:o(()=>[p("h1",null,_(w(r).name),1)]),_:1}),m(t,null,{header:o(()=>[M]),default:o(()=>[m(c,null,{default:o(()=>[(f(!0),D(E,null,O(w(B),l=>(f(),x(s,{key:l.id,color:l.color,timestamp:l.timestamp},{default:o(()=>[p("div",null,_(l.type),1),p("div",null,_(l.label),1)]),_:2},1032,["color","timestamp"]))),128))]),_:1}),w(d)?(f(),D(E,{key:0},[m(k,{size:"small",type:"warning",icon:"SuccessFilled",onClick:e[0]||(e[0]=l=>b("通过"))},{default:o(()=>[I(" 通过 ")]),_:1}),m(k,{size:"small",type:"danger",icon:"Failed",onClick:e[1]||(e[1]=l=>b("否决"))},{default:o(()=>[I(" 否决 ")]),_:1})],64)):L("",!0)]),_:1})]),_:1})}}}),re=H(P,[["__scopeId","data-v-b86a9b45"]]);export{re as default};
